var themeColorMeta=document.querySelector('meta[name="theme-color"]'),pageHeaderEl=document.getElementById("page-header"),navMusicEl=document.getElementById("nav-music"),consoleEl=document.getElementById("console"),selectRandomSong=[],musicVolume=.8,changeMusicListFlag=!1,defaultPlayMusicList=[],anzhiyu={changeThemeColor:function(e){null!==themeColorMeta&&themeColorMeta.setAttribute("content",e)},initThemeColor:function(){let e=getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-bar-background").trim().replace('"',"").replace('"',"");if((window.scrollY||document.documentElement.scrollTop)>56){if(anzhiyu.is_Post()&&(e=getComputedStyle(document.documentElement).getPropertyValue("--anzhiyu-meta-theme-post-color").trim().replace('"',"").replace('"',"")),themeColorMeta.getAttribute("content")===e)return;this.changeThemeColor(e)}else{if(themeColorMeta.getAttribute("content")===e)return;this.changeThemeColor(e)}},is_Post:function(){return window.location.href.indexOf("/posts/")>=0},addNavBackgroundInit:function(){var e=0,t=0;document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),0!=(e-t>0?e:t)&&(pageHeaderEl.classList.add("nav-fixed"),pageHeaderEl.classList.add("nav-visible")),pageHeaderEl.querySelector(".bili-banner")&&(pageHeaderEl.classList.add("nav-fixed"),pageHeaderEl.classList.add("nav-visible"))},downloadImage:function(e,t){rm.hideRightMenu(),0==rm.downloadimging?(rm.downloadimging=!0,btf.snackbarShow("正在下载中，请稍后",!1,1e4),setTimeout((function(){let n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){let e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,n.width,n.height);let a=e.toDataURL("image/png"),i=document.createElement("a"),o=new MouseEvent("click");i.download=t||"photo",i.href=a,i.dispatchEvent(o)},n.src=e,btf.snackbarShow("图片已添加盲水印，请遵守版权协议"),rm.downloadimging=!1}),"10000")):btf.snackbarShow("有正在进行中的下载，请稍后再试")},stopImgRightDrag:function(){$("img").on("dragstart",(function(){return!1}))},scrollTo:function(e){var t=document.querySelector(e).offsetTop;window.scrollTo(0,t-80)},hideAsideBtn:()=>{const e=document.documentElement.classList;e.contains("hide-aside")?saveToLocal.set("aside-status","show",2):saveToLocal.set("aside-status","hide",2),e.toggle("hide-aside"),e.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},switchCommentBarrage:function(){document.querySelector(".comment-barrage")&&($(".comment-barrage").is(":visible")?($(".comment-barrage").hide(),btf.snackbarShow("✨ 已关闭评论弹幕"),$(".menu-commentBarrage-text").text("显示热评"),document.querySelector("#consoleCommentBarrage").classList.remove("on"),localStorage.setItem("commentBarrageSwitch","false")):$(".comment-barrage").is(":hidden")&&($(".comment-barrage").show(),$(".menu-commentBarrage-text").text("关闭热评"),document.querySelector("#consoleCommentBarrage").classList.add("on"),btf.snackbarShow("✨ 已开启评论弹幕"),localStorage.removeItem("commentBarrageSwitch"))),rm.hideRightMenu()},initIndexEssay:function(){document.querySelector(".essay_bar_swiper_container")&&setTimeout((()=>{let e=new Swiper(".essay_bar_swiper_container",{passiveListeners:!0,direction:"vertical",loop:!0,autoplay:{disableOnInteraction:!0,delay:3e3},mousewheel:!0}),t=document.getElementById("bbtalk");null!==t&&(t.onmouseenter=function(){e.autoplay.stop()},t.onmouseleave=function(){e.autoplay.start()})}),100)},diffDate:function(e,t=!1){const n=new Date,a=new Date(e),i=n.getTime()-a.getTime(),o=36e5,s=24*o;let c;if(t){const e=i/s,t=i/o,n=i/6e4;c=i/2592e6>=1?a.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else c=parseInt(i/s);return c},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=anzhiyu.diffDate(n,!0),t.style.display="inline"}))},changeTimeInAlbumDetail:function(){document.querySelector("#album_detail")&&document.querySelectorAll("#album_detail time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=anzhiyu.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){const e=document.getElementById("waterfall");e&&setTimeout((function(){waterfall(e),e.classList.add("show")}),800)},sayhi:function(){const e=document.getElementById("author-info__sayhi");e&&(e.innerHTML=getTimeState()+"！我是")},addFriendLink(){var e=document.getElementsByClassName("el-textarea__inner")[0];if(!e)return;let t=document.createEvent("HTMLEvents");t.initEvent("input",!0,!0),e.value="昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n",e.dispatchEvent(t),e.focus(),e.setSelectionRange(-1,-1)},musicToggle:function(e=!0){anzhiyu_musicFirst||(musicBindEvent(),anzhiyu_musicFirst=!0);anzhiyu_musicPlaying?(navMusicEl.classList.remove("playing"),document.getElementById("menu-music-toggle").innerHTML='<i class="fa-solid fa-play"></i><span>播放音乐</span>',document.getElementById("nav-music-hoverTips").innerHTML="音乐已暂停",document.querySelector("#consoleMusic").classList.remove("on"),anzhiyu_musicPlaying=!1,navMusicEl.classList.remove("stretch")):(navMusicEl.classList.add("playing"),document.getElementById("menu-music-toggle").innerHTML='<i class="fa-solid fa-pause"></i><span>暂停音乐</span>',document.querySelector("#consoleMusic").classList.add("on"),anzhiyu_musicPlaying=!0,navMusicEl.classList.add("stretch")),e&&document.querySelector("#nav-music meting-js").aplayer.toggle()},musicTelescopic:function(){navMusicEl.classList.contains("stretch")?navMusicEl.classList.remove("stretch"):navMusicEl.classList.add("stretch")},musicSkipBack:function(){navMusicEl.querySelector("meting-js").aplayer.skipBack()},musicSkipForward:function(){navMusicEl.querySelector("meting-js").aplayer.skipForward()},musicGetName:function(){for(var e=$(".aplayer-title"),t=[],n=e.length-1;n>=0;n--)t[n]=e[n].innerText;return t[0]},darkModeStatus:function(){"light"==("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?$(".menu-darkmode-text").text("深色模式"):$(".menu-darkmode-text").text("浅色模式")},initConsoleState:function(){document.documentElement.classList.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},rewardShowConsole:function(){consoleEl.classList.add("reward-show"),anzhiyu.initConsoleState()},hideConsole:function(){consoleEl.classList.contains("show")?consoleEl.classList.remove("show"):consoleEl.classList.contains("reward-show")&&consoleEl.classList.remove("reward-show")},cacheAndPlayMusic(){let e=localStorage.getItem("musicData");if(e){e=JSON.parse(e);if((new Date).getTime()-e.timestamp<864e5)return void anzhiyu.playMusic(e.songs)}fetch("/json/music.json").then((e=>e.json())).then((e=>{const t={timestamp:(new Date).getTime(),songs:e};localStorage.setItem("musicData",JSON.stringify(t)),anzhiyu.playMusic(e)}))},playMusic(e){const t=document.getElementById("anMusic-page").querySelector("meting-js").aplayer,n=e[Math.floor(Math.random()*e.length)],a=t.list.audios;if(selectRandomSong.includes(n.name)){let i=!1;for(;!i;){const n=e[Math.floor(Math.random()*e.length)];if(selectRandomSong.includes(n.name)||(t.list.add([n]),t.list.switch(a.length),selectRandomSong.push(n.name),i=!0),selectRandomSong.length===e.length)break}if(!i){const e=a.findIndex((e=>e.name===n.name));-1!=e&&t.list.switch(e)}}else t.list.add([n]),t.list.switch(a.length),selectRandomSong.push(n.name);console.info("已随机歌曲：",selectRandomSong,"本次随机歌曲：",n.name)},changeMusicBg:function(e=!0){const t=document.getElementById("an_music_bg");if(e){const e=document.querySelector("#anMusic-page .aplayer-pic");t.style.backgroundImage=e.style.backgroundImage}else{let e=setInterval((()=>{document.querySelector("#anMusic-page .aplayer-pic")&&(clearInterval(e),anzhiyu.addEventListenerMusic(),anzhiyu.changeMusicBg(),document.querySelector("#nav-music meting-js").aplayer&&!document.querySelector("#nav-music meting-js").aplayer.audio.paused&&anzhiyu.musicToggle())}),100)}},getCustomPlayList:function(){if(!window.location.pathname.startsWith("/music/"))return;const e=new URLSearchParams(window.location.search),t=document.getElementById("anMusic-page-meting");if(e.get("id")&&e.get("server")){const n=e.get("id"),a=e.get("server");t.innerHTML=`<meting-js id="${n}" server=${a} type="playlist" type="playlist" mutex="true" preload="auto" theme="var(--anzhiyu-main)" order="list"></meting-js>`}else t.innerHTML='<meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="auto" theme="var(--anzhiyu-main)" order="list" list-max-height="calc(100vh - 169px)!important"></meting-js>';anzhiyu.changeMusicBg(!1)},hideTodayCard:function(){document.getElementById("todayCard")&&document.getElementById("todayCard").classList.add("hide")},addEventListenerMusic:function(){const e=document.getElementById("anMusic-page"),t=e.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu"),n=e.querySelector("#anMusicBtnGetSong"),a=e.querySelector("#anMusicRefreshBtn"),i=e.querySelector("#anMusicSwitching"),o=e.querySelector("meting-js").aplayer;o.volume(.8,!0),o.on("loadeddata",(function(){anzhiyu.changeMusicBg()})),t.addEventListener("click",(function(){document.getElementById("menu-mask").style.display="block",document.getElementById("menu-mask").style.animation="0.5s ease 0s 1 normal none running to_show"})),document.getElementById("menu-mask").addEventListener("click",(function(){"/music/"==window.location.pathname&&e.querySelector(".aplayer-list").classList.remove("aplayer-list-hide")})),n.addEventListener("click",(()=>{if(changeMusicListFlag){const e=document.getElementById("anMusic-page").querySelector("meting-js").aplayer,t=e.list.audios,n=Math.floor(Math.random()*t.length);e.list.switch(n)}else anzhiyu.cacheAndPlayMusic()})),a.addEventListener("click",(()=>{localStorage.removeItem("musicData"),btf.snackbarShow("已移除相关缓存歌曲")})),i.addEventListener("click",(()=>{anzhiyu.changeMusicList()})),document.addEventListener("keydown",(function(e){"Space"===e.code&&(e.preventDefault(),o.toggle()),39===e.keyCode&&(e.preventDefault(),o.skipForward()),37===e.keyCode&&(e.preventDefault(),o.skipBack()),38===e.keyCode&&musicVolume<=1&&(musicVolume+=.1,o.volume(musicVolume,!0)),40===e.keyCode&&musicVolume>=0&&(musicVolume+=-.1,o.volume(musicVolume,!0))}))},changeMusicList:async function(){const e=document.getElementById("anMusic-page").querySelector("meting-js").aplayer,t=(new Date).getTime(),n=JSON.parse(localStorage.getItem("musicData"))||{timestamp:0};let a=[];if(changeMusicListFlag)a=defaultPlayMusicList;else if(defaultPlayMusicList=e.list.audios,t-n.timestamp<864e5)a=n.songs;else{const e=await fetch("/json/music.json");a=await e.json(),n.timestamp=t,n.songs=a,localStorage.setItem("musicData",JSON.stringify(n))}e.list.clear(),e.list.add(a),changeMusicListFlag=!changeMusicListFlag},addEventListenerConsoleMusicList:function(){const e=document.getElementById("nav-music");e&&e.addEventListener("click",(t=>{const n=e.querySelector(".aplayer-list"),a=e.querySelector("div.aplayer-info > div.aplayer-controller > div.aplayer-time.aplayer-time-narrow > button.aplayer-icon.aplayer-icon-menu svg");t.target!=a&&n.classList.contains("aplayer-list-hide")&&n.classList.remove("aplayer-list-hide")}))},toPage:function(){var e=document.querySelectorAll(".page-number"),t=e[e.length-1].innerHTML,n=Number(t),a=document.getElementById("toPageText"),i=Number(a.value);if(""!=i&&!isNaN(i)&&i%1==0)if(1==i)document.getElementById("toPageButton").href="/";else if(i>n){var o="/page/"+n+"/";document.getElementById("toPageButton").href=o}else o="/page/"+a.value+"/",document.getElementById("toPageButton").href=o},removeBodyPaceClass:function(){$("body").removeClass(),$("body").addClass("pace-done")},setValueToBodyType:function(){const e=document.getElementById("page-type").value;document.body.dataset.type=e},addRandomCommentInfo:function(){const e=`${adjectives[Math.floor(Math.random()*adjectives.length)]}${vegetablesAndFruits[Math.floor(Math.random()*vegetablesAndFruits.length)]}`;!function(){for(var t=["#author","input[name='comname']","#inpName","input[name='author']","#ds-dialog-name","#name","input[name='nick']","#comment_author"],n=["#mail","#email","input[name='commail']","#inpEmail","input[name='email']","#ds-dialog-email","input[name='mail']","#comment_email"],a=0;a<t.length;a++){var i=document.querySelector(t[a]);if(null!=i){i.value=e,i.dispatchEvent(new Event("input")),i.dispatchEvent(new Event("change"));break}}for(var o=0;o<n.length;o++){var s=document.querySelector(n[o]);if(null!=s){s.value=visitorMail,s.dispatchEvent(new Event("input")),s.dispatchEvent(new Event("change"));break}}}();var t=document.getElementsByClassName("el-textarea__inner")[0];t.focus(),t.setSelectionRange(-1,-1)}},getTimeState=function(){var e=(new Date).getHours(),t="";return 0<=e&&e<=5?t="晚安😴":5<e&&e<=10?t="早上好👋":10<e&&e<=14?t="中午好👋":14<e&&e<=18?t="下午好👋":18<e&&e<=24&&(t="晚上好👋"),t};document.getElementById("page-name").innerText=document.title.split(" | HUGEH4rD")[0],anzhiyu.initIndexEssay(),anzhiyu.changeTimeInEssay(),anzhiyu.removeBodyPaceClass(),anzhiyu.changeTimeInAlbumDetail(),anzhiyu.reflashEssayWaterFall(),anzhiyu.sayhi(),anzhiyu.stopImgRightDrag(),anzhiyu.addNavBackgroundInit(),anzhiyu.setValueToBodyType(),anzhiyu.getCustomPlayList(),anzhiyu.addEventListenerConsoleMusicList(!1),mouseleaveHomeCard(),coverColor(),anzhiyuScrollFn(),listenToPageInputPress();