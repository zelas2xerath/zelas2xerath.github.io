<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start -->
<link rel="stylesheet" href="/css/bilicard.css">
<!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>BRICS-FS-11_云计算赛项样题 | HugeH4rD</title><meta name="keywords" content="ChinaSkills,云计算,金砖,样题,职业技能大赛"><meta name="author" content="Zelas2Xerath"><meta name="copyright" content="Zelas2Xerath"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="BRICS-FS-11_云计算赛项样题"><meta name="application-name" content="BRICS-FS-11_云计算赛项样题"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="BRICS-FS-11_云计算赛项样题"><meta property="og:url" content="https://blog.806006.xyz/2023/03/01/BRICS-FS-11/index.html"><meta property="og:site_name" content="HugeH4rD"><meta property="og:description" content="2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题解析"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s2.loli.net/2022/06/15/FCSyTrh1zm9JoUN.jpg"><meta property="article:author" content="Zelas2Xerath"><meta property="article:tag" content="HugeHard"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2022/06/15/FCSyTrh1zm9JoUN.jpg"><meta name="description" content="2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题解析"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.806006.xyz/2023/03/01/BRICS-FS-11/"><link rel="preconnect" href="//npm.elemecdn.com"/><link rel="preconnect" href="//npm.onmicrosoft.cn"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?https://hm.baidu.com/hm.js?507aaada61753bb4ef1c80e5ec474730";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"HUGEH4rD","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":null,"Referer":null},
  diytitle: undefined,
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://c.806006.xyz/',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"http://f.806006.xyz:65200/"},
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: undefined,
  algolia: {"appId":"CSB4N1T1KG","apiKey":"1464ef4919d9840097b34ad63316b351","indexName":"hexo","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"这篇文章已经有","messageNext":"天没有更新了, 其中的某些内容可能已经过期."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":true,"limitCount":666,"languages":{"author":"作者: Zelas2Xerath","link":"链接: ","source":"来源: HugeH4rD","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#3b70fc","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'HugeH4rD',
  title: 'BRICS-FS-11_云计算赛项样题',
  postAI: '',
  pageFillDescription: '2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题, A 场次题目：OpenStack  平台部署与运维, 任务 1 私有云平台环境初始化（5 分）, 1.初始化操作系统, 2.挂载安装光盘镜像, 3.设置 yum 源, 4.搭建文件共享服务器, 5.部署时间同步服务器, 任务 2  OpenStack 搭建任务（10 分）, 1.修改变量文件, 2.搭建数据库组件, 3.搭建认证服务组件, 4.搭建镜像服务组件, 5.搭建计算服务组件, 6.搭建网络组件并初始化网络, 7.搭建图形化界面, 任务 3  OpenStack 运维任务, 1.用户管理, 2.服务查询, 3.镜像管理, 4.后端配置文件管理, 5.存储服务管理, 6.存储服务管理, 7.对象存储管理, 8.安全组管理, 9.网络管理, 10.网络管理, 11.虚拟机管理, B 场次题目：容器的编排与运维, 任务 1 容器云平台环境初始化（5 分）, 1.容器云平台的初始化, 2.Yum 源数据的持久化挂载, 3.Yum 源的编写, 4.设置时间同步服务器, 5.设置免密登录, 任务 2  k8s 搭建任务（10 分）, 1.安装 docker 应用, 2．搭建 horbor 仓库, 3．安装 docker-compose, 4．上传 docker 镜像, 5．安装 kubeadm 工具, 6．计算节点获取必备镜像, 7．kubeadm 安装 master, 8．安装 kubernetes 网络插件, 9．kubernetes 图形化界面的安装, 10．扩展计算节点, 任务三K8s 运维任务（15 分）, 1.使用dockerfile 构建dokcer 镜像, 2.持久化存储, 3.编写deployment 文件, 4.创建 service 服务提供对外访问接口, 5.配置metrics-server 实现资源监控, 6.配置弹性伸缩, 7.压力测试, C 场次题目：企业级应用的自动化部署和运维, 任务1 企业级应用的自动化部署（15 分）, 1.ansible 自动化运维工具的安装【3 分】, 2.ansible 自动化运维工具的初始化【3 分】, 3.主机清单的编写【2 分】, 4.使用自动化工具对 master 节点进行初始化【2 分】, 5.使用自动化运维工具完成企业级应用的部署【5 分】, 任务2 企业级应用的运维（12 分）, 1.使用prometheus 监控mysqld 服务【3 分】, 2.安装alertmanager 报警组件【3 分】, 3.alertmanager 告警邮件文件编写【3 分】, 4.alertmanager 告警规则编写【3 分】, 任务 3 企业级微服务运维（13 分）, 1.在K8S 集群安装istio【4 分】, 2.部署基于在线书店bookinfo【6 分】, 3.部署网关接口实现对外服务【3 分】年金砖国家职业技能大赛云计算赛项样题校验勘误场次题目平台部署与运维业务场景某企业拟使用搭建一个企业云平台用于部署各类企业应用对外对内服务云平台可实现资源池化弹性分配集中管理性能优化以及统一安全认证等企业云平台的搭建使用竞赛平台提供的两台云服务器配置如下表设备名称主机名接口地址说明云服务器云服务器任务私有云平台环境初始化分初始化操作系统使用提供的用户名密码登录竞赛云平台根据表中的地址规划设置各服务器节点的地址确保网络正常通信设置控制节点主机名为计算节点主机名为并修改文件将地址映射为主机名设置为模式并设置永久关闭请查看控制节点和计算节点主机名使用命令查看状态使用命令命令或命令提取出永久关闭的关键信息将以上命令及返回结果提交到答题框分挂载安装光盘镜像将提供的和光盘镜像上传到节点目录下然后在目录下使用一条命令创建目录和目录并将镜像文件挂载到目录下将镜像文件挂载到目录下请将以上命令及返回结果返回到答题框分设置源将仓库设置为为节点设置本地源源文件名为为配置源源文件名称为其中服务器地址为节点请将两个节点的源文件内容提交到答题框分搭建文件共享服务器在节点上安装服务器设置开机自启动请将以上命令及返回结果提交到答题框分部署时间同步服务器在节点上部署服务器允许其他节点同步时间启动服务并设置为开机启动在节点上指定节点为上游服务器重启服务并设为开机启动请在控制节点上使用命令同步控制节点的系统时间分任务搭建任务分修改变量文件在控制节点和计算节点上分别安装软件包修改配置脚本文件中基本变量配置脚本文件为修改完成后使用命令生效该变量文件然后执行命令请将命令和返回结果提交到答题框分手动填充剩余部分修改第行的地址为地址搭建数据库组件使用提供的脚本框架在节点上安装等服务并完成相关配置完成后修改配置文件将最大连接数修改为请将修改后的配置文件提交到答题框分搭建认证服务组件使用提供的脚本框架填充脚本在节点上安装服务并完成相关配置完成后使用命令请求一个请将以上命令和返回结果提交到答题框分搭建镜像服务组件使用提供的脚本框架填充脚本在节点上安装服务并完成相关配置完成后请将上传到控制节点的目录下然后使用命令将该镜像上传到平台镜像命名为请将镜像上传的操作命令和返回结果提交到答题框分搭建计算服务组件使用提供的脚本框架和填充脚本在和节点上安装服务并完成配置完成后请将控制节点的计算资源也加入集群然后使用命令列出能提供计算资源的节点将列出计算资源的命令和返回结果提交到答题框分查看虚拟化节点列表在控制节点查看计算服务的工作状态搭建网络组件并初始化网络使用提供的脚本框架和填充脚本在和节点上安装服务并完成配置创建云主机外部网络子网为云主机浮动可用网段为网关为创建云主机内部网络子网为云主机子网可用网段为网关为创建云主机内部网络子网为云主机子网可用网段为网关为添加名为的路由器添加网关在网络添加内部端口到网络完成内部网络和外部网络的连通请使用命令完成以下任务完成后将命令和返回结果提交到答题框分搭建图形化界面使用提供的脚本框架填充脚本在节点上安装服务并完成相关配置请使用指令获取首页信息将获取到的首页信息提交到答题框分任务运维任务用户管理在中创建用户密码为创建好之后使用命令修改密码为并查看的详细信息添加将该用户添加到项目并赋予普通用户权限完成后测试登录使用用登录系统完成后截图并提交到答题框分服务查询使用命令列出服务目录和端点查看服务的端点将以上命令和返回结果提交到答题框分镜像管理登录节点使用相关命令上传镜像源使用名字为然后使用命令修改这个镜像名改为然后给这个镜像打一个标签标签名字为改完后使用命令查看镜像列表将以上命令和返回结果提交到答题框分后端配置文件管理进入到后端存储目录中使用命令查看任意的一个镜像信息使用命令查看主配置文件大小将以上命令和返回结果提交到答题框分存储服务管理创建一个卷类型然后创建一块带这个卷类型标识的云硬盘查询该云硬盘的详细信息将该云硬盘挂载到虚拟机中将该云硬盘格式化为创建一个文件文件名为工位号内容为工位号然后将该云硬盘卸载使用命令将该云硬盘修改为只读状态再次挂载后查看是否存在原始文件然后再次向该云硬盘中创建一个文件文件名为工位号将返回结果及解题过程提交到答题框分存储服务管理使用命令创建一个的云硬盘名称为将云硬盘挂载到云虚拟机内然后格式化为挂载到虚拟机的目录下使用将命令和返回信息提交到答题框将该云硬盘使用命令卸载使用命令将该云硬盘扩容到使用命令将云硬盘挂载到云主机上将命令及返回信息提交到答题框进入云主机使用命令扩容文件系统扩容后再次挂载到使用命令并将命令和返回信息提交到答题框分对象存储管理使用相关命令创建一个容器然后往这个容器中上传一个文件文件可以自行创建上传完毕后使用命令查看容器将以上命令和返回结果提交到答题框分安全组管理使用命令创建名称为的安全组该安全组的描述为工位号为该安全组添加一条规则允许任意地址访问流量完成后查看该安全组的详细信息将以上命令和返回结果提交到答题框分网络管理使用命令将网络设置为共享然后查看网络的详细信息将命令和返回信息提交到答题框分网络管理使用界面使用镜像创建一台云主机云主机命名为使用命令查看浮动地址池使用命令创建一个浮动然后将浮动绑定到云主机上将命令和返回信息提交到答题框分虚拟机管理使用命令利用镜像创建一台云主机连接网络云主机名称为创建成功后使用命令查看云主机详细信息确定该云主机是处于计算节点还是控制节点如果云主机处于控制节点上请将其冷迁移到计算节点如果如果云主机处于计算节点上请将其冷迁移到控制节点本题全部流程请使用命令完成请将全部命令和结果粘贴到答题框分场次题目容器的编排与运维某企业计划使用平台搭建后台管理系统以实现完成公司内部日常工作管理例如管理用户管理客户关系管理等业务设备名称主机名接口地址云服务器云服务器云服务器云服务器任务容器云平台环境初始化分容器云平台的初始化根据表中的地址规划创建云服务器镜像使用确保网络正常通信按照表设置主机名节点并关闭同时永久关闭以及防火墙并修改映射请将节点文件内容提交到答题框分源数据的持久化挂载将提供的和光盘镜像上传到节点目录下然后在目录下使用命令创建目录和目录并将镜像文件挂载到目录下将镜像文件挂载到目录下请设置永久开机自动挂载并将设置的永久开机自动挂载的文件内容提交到答题框分源的编写为节点设置本地源源文件名为安装服务将仓库设置为为其他节点配置源源文件名称为其中服务器地址为节点请将其它节点的源文件内容提交到答题框分设置时间同步服务器在节点上部署服务器允许其他节点同步时间启动服务并设置为开机启动在其他节点上指定节点为上游服务器重启服务并设为开机启动请在节点上使用命令同步控制节点的系统时间分设置免密登录为四台服务器设置免密登录保证台服务器能够互相免密登录请使用命令将节点的文件发送到所有节点的将以上所有命令和返回结果提交到答题框分任务搭建任务分安装应用在所有节点上安装并在节点安装仓库显现正常登录仓库登录密码设置为工位号请将登录后截图提交到答题框分搭建仓库修改默认仓库为地址修改启动引擎为安装完成后执行命令返回结果以及将文件内容提交分安装在节点上使用下的文件安装安装完成后执行命令请将程序返回结果提交到答题框分上传镜像在节点使用将所有镜像上传至仓库完成后将仓库中镜像列表截图请将以上截图提交到答题框分可替代的方案安装工具在及节点安装工具并设置开机自动启动安装完成后使用命令配合查看工具是否正确安装将命令配合返回结果提交到答题框分计算节点获取必备镜像在所有节点中使用命令拉取安装基础镜像拉取完成后使用命令查看镜像列表分安装使用命令初始化节点设置虚拟内部网段地址为然后使用完成控制节点初始化设置完成后使用命令查看集群状态和所有可替代的方案安装网络插件使用安装网络插件安装完成后使用命令查看节点状态完成后使用命令查看集群状态将集群状态查看命令和返回结果提交到答题框分可替代的方案需要修改图形化界面的安装安装界面完成后查看首页然后将界面截图提交到答题框分可替代的方案需要修改获取扩展计算节点在节点上使用命令查看在所有节点上使用命令将节点加入集群完成后在节点上查看所有节点状态将集群状态查看命令和返回结果提交到答题框分可替代的方案任务三运维任务分使用构建镜像以镜像为基础镜像制作一个镜像可以将提供的文件初始化到数据库中然后使用编写的文件将镜像制作出来名称为并将该镜像上传至前面所搭建的仓库中编写文件验证数据库内容完成后将文件内容及仓库镜像列表数据库内容提交到答题框分持久化存储搭建共享存储配置创建通过动态生成大小为修改标准文件编写和文件将最终状态截图和文件提交至答题框分编写文件将提供的镜像上传至镜像仓库使用该镜像编写文件要求将已创建的挂载至目录下副本数实现资源限制需求内存需求限制内存限制将状态截图和文件提交至答题框分创建服务提供对外访问接口基于的服务编写一个名称为代理的服务端口端口类型为创建成功后可以通过该访问完成后提交文件及访问截图至答题框分配置实现资源监控将已提供的镜像上传至修改创建完成后将状态截图提交至答题框分修改文件搜索将地址改为仓库地址在参数下添加配置弹性伸缩编写文件要求最小副本数最大副本数当整体的资源利用率超过的时候实现自动扩容将文件提交至答题框分压力测试安装工具通过提供的对外访问接口进行压力测试验证弹性伸缩功能将状态和状态截图提交至答题框分场次题目企业级应用的自动化部署和运维主机名地址角色私有云下发私有云下发私有云下发任务企业级应用的自动化部署分自动化运维工具的安装分请使用提供的软件包在节点安装安装完成后使用命令验证是否安装成功为所有节点添加用户设置用户密码为为用户设置免密配置免密登录使节点能够免密登录所有节点的用户将命令和回显粘贴到答题框自动化运维工具的初始化分创建目录作为工作目录在该目录内创建文件并完成以下配置清单文件位置为登录用户为登录时不需要输入密码设置并行主机数量为允许用户免密提权到将文件内容粘贴到答题框主机清单的编写分编写主机清单文件创建用户组用户组内添加主机创建用户组组内添加和主机主机名不得使用地址完成后执行和命令将这三条命令返回结果粘贴到答题框组环境组环境组环境使用自动化工具对节点进行初始化分请编写控制主机组使用对应模块将临时状态和开机启动状态也设置为请使用对应模块安装时间同步服务使用文本编辑模块将该服务的作用域设置为并设置状态为启动和开机自动启动首先将提供的使用文件拷贝模块将该压缩包拷贝到目标主机的下使用模块解压该压缩包使用自动化运维工具完成企业级应用的部署分编写模板文件将所有节点信息添加到该文件中但是被管节点的主机名信息必须使用变量地址可以手动输入完成后请创建文件编写第一个将该命名为该控制的主机组为使用模块将发送到主机组的下使用一个模块解压该压缩包并启动该服务随后编写第二个将第二个命名为第二个控制节点首先使用模块将文件传输到节点然后使用模块将启动使用对应模块将包发送到被控节点的目录下然后使用对应模块将该软件包安装安装完成后设置服务启动并设置开机自动启动使用浏览器登录查看是否成功监控所有节点请将浏览器反馈的结果截图文件的内容文件内容及运行结果提交到答题框任务企业级应用的运维分使用监控服务分将提供的发送到虚拟机目录下解压并安装服务进入数据库中创建用户并授权然后创建配置文件内容为数据库用户名密码启动组件确保端口启动回到节点修改文件并添加被监控信息重启随后界面刷新并查看被控信息将以上操作提交到答题框安装报警组件分将提供的上传到节点目录下并解压创建软连接创建启动文件然后启动查看端口在配置文件中添加信息并重新启动服务在上停止服务到界面中查看警报管理器状态是否正常和状态是否异常将操作命令及截图提交到答题框告警邮件文件编写分虚拟机中存在着一个文件请根据提供的地址和模板编写告警所发送到的邮箱地址信息将配置文件中编写的内容提交到答题框告警规则编写分在虚拟机的路径下存在一个目录目录下有一个文件请根据提供信息仿照模板编写内存大于报警规则资源利用率大于报警规则主机磁盘每秒读取数据报警规则部门名称可为工位号将配置文件内容提交到答题框容器资源利用率大于负载告警主机内存使用率告警内存利用率大于实例当前值高负载磁盘正在读取大量数据任务企业级微服务运维分在集群安装分将上传至节点并解压至目录下将目录内容器镜像文件上传至各节点中并且加载完成初始化安装将部署成功后三台状态截图提交答题框部署基于在线书店分是一个在线书店微服务应用应用分为四个单独的微服务这个微服务会调用和两个微服务用来生成页面这个微服务中包含了书籍的信息这个微服务中包含了书籍相关的评论它还会调用微服务这个微服务中包含了由书籍评价组成的评级信息微服务有个版本版本不会调用服务版本会调用服务并使用到个黑色星形图标来显示评分信息版本会调用服务并使用到个红色星形图标来显示评分信息实现该应用服务网格的部署利用控制平面为应用提供服务路由监控数据收集以及策略实施等功能部署架构如下编写构建镜像具体要求如下基础镜像安装工具安装服务并设置开机自启规划应用微服务部署架构在容器集群中通过修改微服务应用的文件来完成微服务应用的部署在容器集群中设置熔断规则对其中的微服务设置熔断规则并通过负载测试客户端触发熔断机制进行验证部署网关接口实现对外服务分通过部署网关通过外部浏览器登陆请将浏览器反馈的结果截图提交答题框',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-01 22:00:00',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/img/avatar.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.806006.xyz/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.806006.xyz/img/favicon.png" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://pan.806006.xyz/" title="云盘主线"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.806006.xyz/img/favicon.png" alt="云盘主线"/><span class="back-menu-item-text">云盘主线</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://yun.806006.xyz/" title="云盘备线"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.806006.xyz/img/favicon.png" alt="云盘备线"/><span class="back-menu-item-text">云盘备线</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://axerath.gitee.io/" title="Gitee Page"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.806006.xyz/img/favicon.png" alt="Gitee Page"/><span class="back-menu-item-text">Gitee Page</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="http://zelas2xerath.github.io/" title="Github Page"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.806006.xyz/img/favicon.png" alt="Github Page"/><span class="back-menu-item-text">Github Page</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">HugeH4rD</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 板块</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Openwrt/"><i class="fa-solid fa-wifi faa-tada"></i><span> OpenWrt</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Pwn/"><i class="fa-solid fa-0 faa-tada"></i><span> Pwn</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Reverse/"><i class="fa-brands fa-500px faa-tada"></i><span> Reverse</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Net/"><i class="fa-brands fa-battle-net faa-tada"></i><span> Net</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 好物清单</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.jpg"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/NET/" style="font-size: 1.05rem;">.NET<sup>1</sup></a><a href="/tags/AMD/" style="font-size: 1.05rem;">AMD<sup>1</sup></a><a href="/tags/AWX/" style="font-size: 1.05rem;">AWX<sup>1</sup></a><a href="/tags/ChinaSkills/" style="font-size: 1.05rem;">ChinaSkills<sup>2</sup></a><a href="/tags/DIY/" style="font-size: 1.05rem;">DIY<sup>1</sup></a><a href="/tags/DirectX/" style="font-size: 1.05rem;">DirectX<sup>1</sup></a><a href="/tags/GPU/" style="font-size: 1.05rem;">GPU<sup>1</sup></a><a href="/tags/IDA/" style="font-size: 1.05rem;">IDA<sup>1</sup></a><a href="/tags/KVM/" style="font-size: 1.05rem;">KVM<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 1.05rem;">Markdown<sup>1</sup></a><a href="/tags/Office/" style="font-size: 1.05rem;">Office<sup>1</sup></a><a href="/tags/Openwrt/" style="font-size: 1.05rem;">Openwrt<sup>8</sup></a><a href="/tags/Potplayer/" style="font-size: 1.05rem;">Potplayer<sup>1</sup></a><a href="/tags/Pwn/" style="font-size: 1.05rem;">Pwn<sup>1</sup></a><a href="/tags/Python/" style="font-size: 1.05rem;">Python<sup>1</sup></a><a href="/tags/RHCE/" style="font-size: 1.05rem;">RHCE<sup>1</sup></a><a href="/tags/RHCSA/" style="font-size: 1.05rem;">RHCSA<sup>1</sup></a><a href="/tags/Redhat/" style="font-size: 1.05rem;">Redhat<sup>2</sup></a><a href="/tags/Runtimes/" style="font-size: 1.05rem;">Runtimes<sup>4</sup></a><a href="/tags/Ryzen/" style="font-size: 1.05rem;">Ryzen<sup>1</sup></a><a href="/tags/Windows/" style="font-size: 1.05rem;">Windows<sup>12</sup></a><a href="/tags/ansible/" style="font-size: 1.05rem;">ansible<sup>1</sup></a><a href="/tags/cpu/" style="font-size: 1.05rem;">cpu<sup>3</sup></a><a href="/tags/eNSP/" style="font-size: 1.05rem;">eNSP<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 1.05rem;">hexo<sup>2</sup></a><a href="/tags/idm/" style="font-size: 1.05rem;">idm<sup>1</sup></a><a href="/tags/iperf/" style="font-size: 1.05rem;">iperf<sup>1</sup></a><a href="/tags/pip/" style="font-size: 1.05rem;">pip<sup>1</sup></a><a href="/tags/pwn/" style="font-size: 1.05rem;">pwn<sup>1</sup></a><a href="/tags/python/" style="font-size: 1.05rem;">python<sup>1</sup></a><a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 1.05rem;">云计算<sup>2</sup></a><a href="/tags/%E6%98%BE%E7%A4%BA%E5%99%A8/" style="font-size: 1.05rem;">显示器<sup>1</sup></a><a href="/tags/%E6%A0%B7%E9%A2%98/" style="font-size: 1.05rem;">样题<sup>2</sup></a><a href="/tags/%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" style="font-size: 1.05rem;">职业技能大赛<sup>2</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 1.05rem;">虚拟化<sup>1</sup></a><a href="/tags/%E8%A3%85%E6%9C%BA/" style="font-size: 1.05rem; font-weight: 500; color: var(--anzhiyu-lighttext)">装机<sup>3</sup></a><a href="/tags/%E8%B6%85%E9%A2%91/" style="font-size: 1.05rem;">超频<sup>2</sup></a><a href="/tags/%E9%85%8D%E7%BD%AE%E5%8D%95/" style="font-size: 1.05rem;">配置单<sup>2</sup></a><a href="/tags/%E9%87%91%E7%A0%96/" style="font-size: 1.05rem;">金砖<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">七月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/06/"><span class="card-archive-list-date">六月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">11</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url">运维</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/ChinaSkills/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>ChinaSkills</span></a><a class="article-meta__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>云计算</span></a><a class="article-meta__tags" href="/tags/%E9%87%91%E7%A0%96/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>金砖</span></a><a class="article-meta__tags" href="/tags/%E6%A0%B7%E9%A2%98/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>样题</span></a><a class="article-meta__tags" href="/tags/%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>职业技能大赛</span></a></span></div></div><h1 class="post-title" itemprop="name headline">BRICS-FS-11_云计算赛项样题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-03-01T14:00:00.000Z" title="发表于 2023-03-01 22:00:00">2023-03-01</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2023-03-01T14:00:00.000Z" title="更新于 2023-03-01 22:00:00">2023-03-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">10.8k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>49分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="BRICS-FS-11_云计算赛项样题"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为杭州"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>杭州</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://s2.loli.net/2022/06/15/FCSyTrh1zm9JoUN.jpg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://blog.806006.xyz/2023/03/01/BRICS-FS-11/"><header><a class="post-meta-categories" href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url">运维</a><a href="/tags/ChinaSkills/" tabindex="-1" itemprop="url">ChinaSkills</a><a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" tabindex="-1" itemprop="url">云计算</a><a href="/tags/%E9%87%91%E7%A0%96/" tabindex="-1" itemprop="url">金砖</a><a href="/tags/%E6%A0%B7%E9%A2%98/" tabindex="-1" itemprop="url">样题</a><a href="/tags/%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" tabindex="-1" itemprop="url">职业技能大赛</a><h1 id="CrawlerTitle" itemprop="name headline">BRICS-FS-11_云计算赛项样题</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Zelas2Xerath</span><time itemprop="dateCreated datePublished" datetime="2023-03-01T14:00:00.000Z" title="发表于 2023-03-01 22:00:00">2023-03-01</time><time itemprop="dateCreated datePublished" datetime="2023-03-01T14:00:00.000Z" title="更新于 2023-03-01 22:00:00">2023-03-01</time></header><h1 id="2022-年金砖国家职业技能大赛BRICS-FS-11-云计算赛项样题"><a href="#2022-年金砖国家职业技能大赛BRICS-FS-11-云计算赛项样题" class="headerlink" title="2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题"></a>2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题</h1><p><strong>校验：</strong><code>@Zelas2Xerath</code></p>
<p><strong>勘误：</strong><code>leancode@189.cn</code></p>
<h2 id="A-场次题目：OpenStack-平台部署与运维"><a href="#A-场次题目：OpenStack-平台部署与运维" class="headerlink" title="A 场次题目：OpenStack  平台部署与运维"></a>A 场次题目：OpenStack  平台部署与运维</h2><p><strong>业务场景：</strong></p>
<p>某企业拟使用openstack 搭建一个企业云平台，用于部署各类企业应用对外对内服务。云平台可实现IT 资源池化、弹性分配、集中管理、性能优化以及统一安全认证等。企业云平台的搭建使用竞赛平台提供的两台云服务器，配置如下表：</p>
<table>
<thead>
<tr>
<th align="center">设备名称</th>
<th align="center">主机名</th>
<th align="center">接口</th>
<th align="center">IP 地址</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">云服务器1</td>
<td align="center">Controller</td>
<td align="center">eth0<br />eth1</td>
<td align="center">172.17.x.10&#x2F;24<br />172.18.x.10&#x2F;24</td>
<td align="center">Vlan 1x0<br />Vlan 2x0</td>
</tr>
<tr>
<td align="center">云服务器2</td>
<td align="center">Compute</td>
<td align="center">eth0<br />eth1</td>
<td align="center">172.17.x.20&#x2F;24<br />172.18.x.20&#x2F;24</td>
<td align="center">Vlan 1x0<br />Vlan 2x0</td>
</tr>
</tbody></table>
<hr>
<h3 id="任务-1-私有云平台环境初始化（5-分）"><a href="#任务-1-私有云平台环境初始化（5-分）" class="headerlink" title="任务 1 私有云平台环境初始化（5 分）"></a>任务 1 私有云平台环境初始化（5 分）</h3><h4 id="1-初始化操作系统"><a href="#1-初始化操作系统" class="headerlink" title="1.初始化操作系统"></a>1.初始化操作系统</h4><p>使用提供的用户名密码，登录竞赛云平台。根据表1 中的IP 地址规划，设置各服务器节点的IP 地址，确保网络正常通信，设置控制节点主机名为Controller，计算节点主机名为 Compute，并修改 hosts 文件将IP 地址映射为主机名，设置 SELinux 为 Permissive 模式并设置永久关闭。请查看控制节点和计算节点主机名，使用命令查看 SELinux 状态，使用 head 命令、tail 命令或 cat 命令提取出永久关闭 SELinux 的关键信息。</p>
<p>将以上命令及返回结果提交到答题框。【2 分】</p>
<p><strong>Controller：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nmcli con add con-name ens32 <span class="built_in">type</span> ethernet ifname ens32 ipv4.address 172.17.2.10/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con add con-name ens33 <span class="built_in">type</span> ethernet ifname ens33 ipv4.address 172.18.2.10/24 ipv4.method static autoconnect <span class="built_in">yes</span> ipv4.gateway 172.18.2.2 ipv4.dns 172.18.2.2</span><br><span class="line">nmcli con up ens32</span><br><span class="line">nmcli con up ens33</span><br><span class="line">hostnamectl set-hostname --static controller</span><br><span class="line">bash</span><br></pre></td></tr></table></figure>

<p><strong>Compute:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nmcli con add con-name ens32 <span class="built_in">type</span> ethernet ifname ens32 ipv4.address 172.17.2.20/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con add con-name ens33 <span class="built_in">type</span> ethernet ifname ens33 ipv4.address 172.18.2.20/24 ipv4.method static autoconnect <span class="built_in">yes</span> ipv4.gateway 172.18.2.2 ipv4.dns 172.18.2.2</span><br><span class="line">nmcli con up ens32</span><br><span class="line">nmcli con up ens33</span><br><span class="line">hostnamectl set-hostname --static compute</span><br><span class="line">bash</span><br></pre></td></tr></table></figure>

<p><strong>Controller &amp; Compute：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/hosts &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">172.17.2.10 controller</span></span><br><span class="line"><span class="string">172.18.2.10 controller</span></span><br><span class="line"><span class="string">172.17.2.20 compute</span></span><br><span class="line"><span class="string">172.18.2.20 compute</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld --now</span><br><span class="line">setenforce 0</span><br><span class="line">sed -i <span class="string">&#x27;s/SELINUX=enforcing/=SELINUX=disabled/g&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl</span><br><span class="line">getenforce</span><br><span class="line"><span class="built_in">cat</span> /etc/selinux/config | grep SELINUX=disabled</span><br></pre></td></tr></table></figure>

<h4 id="2-挂载安装光盘镜像"><a href="#2-挂载安装光盘镜像" class="headerlink" title="2.挂载安装光盘镜像"></a>2.挂载安装光盘镜像</h4><p>将提供的CentOS-7-x86_64-DVD-1804.iso 和chinaskills_cloud_iaas.iso 光盘镜像上传到 Controller 节点&#x2F;root 目录下，然后在&#x2F;opt 目录下使用一条命令创建&#x2F;centos 目录和 &#x2F;iaas 目录，并将镜像文件CentOS-7-x86_64-DVD-1804.iso 挂载到 &#x2F;centos 目录下，将镜像文件 chinaskills_cloud_iaas.iso 挂载到 &#x2F;iaas 目录下。</p>
<p>请将以上命令及返回结果返回到答题框。【1 分】</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scp CentOS-7-x86_64-DVD-1804.iso chinaskills_cloud_iaas.iso root@172.17.2.10:/root</span><br><span class="line"><span class="built_in">mkdir</span> /opt/centos /opt/iaas /mnt/iso</span><br><span class="line">mount -o loop CentOS-7-x86_64-DVD-1804.iso /opt/centos</span><br><span class="line">mount -o loop chinaskills_cloud_iaas.iso /opt/iaas</span><br><span class="line">mount /dev/sr0 /mnt/iso</span><br><span class="line"><span class="built_in">cp</span> -rvf /mnt/iso/* /opt/iaas/</span><br><span class="line">umount /mnt/iso</span><br><span class="line">mount /dev/sr1 /mnt/iso</span><br><span class="line"><span class="built_in">cp</span> -rvf /mnt/iso/* /opt/centos</span><br><span class="line">umount /mnt/iso</span><br></pre></td></tr></table></figure>

<h4 id="3-设置-yum-源"><a href="#3-设置-yum-源" class="headerlink" title="3.设置 yum 源"></a>3.设置 yum 源</h4><p>将ftp 仓库设置为 &#x2F;opt&#x2F;，为 controller 节点设置本地yum 源，yum 源文件名为local.repo；为 compute 配置 ftp 源，yum 源文件名称为 ftp.repo，其中ftp 服务器地址为 controller 节点IP。</p>
<p>请将两个节点的yum 源文件内容提交到答题框。【0.5 分】</p>
<p><strong>Controller：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/yum.repos.d/* /media/</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/yum.repos.d/local.repo &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[centos]</span></span><br><span class="line"><span class="string">name=centos</span></span><br><span class="line"><span class="string">baseurl=file:///opt/centos</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">[iaas]</span></span><br><span class="line"><span class="string">name=iaas</span></span><br><span class="line"><span class="string">baseurl=file:///opt/iaas/iaas-repo</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum repolist</span><br></pre></td></tr></table></figure>

<p><strong>Compute：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/yum.repos.d/* /media/</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/yum.repos.d/local.repo &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[centos]</span></span><br><span class="line"><span class="string">name=centos</span></span><br><span class="line"><span class="string">baseurl=ftp://172.17.2.10/centos</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">[iaas]</span></span><br><span class="line"><span class="string">name=iaas</span></span><br><span class="line"><span class="string">baseurl=ftp://172.17.2.10/iaas/iaas-repo</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum repolist</span><br></pre></td></tr></table></figure>

<h4 id="4-搭建文件共享服务器"><a href="#4-搭建文件共享服务器" class="headerlink" title="4.搭建文件共享服务器"></a>4.搭建文件共享服务器</h4><p>在 Controller 节点上安装 vsftp 服务器，设置开机自启动，请将以上命令及返回结果提交到答题框。【0.5 分】</p>
<p><strong>Controller：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vsftpd</span><br><span class="line">anonymous <span class="built_in">yes</span></span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/vsftpd/vsftpd.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">anon_root=/opt</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> vsftpd --now</span><br></pre></td></tr></table></figure>

<h4 id="5-部署时间同步服务器"><a href="#5-部署时间同步服务器" class="headerlink" title="5.部署时间同步服务器"></a>5.部署时间同步服务器</h4><p>在Controller 节点上部署chrony 服务器，允许其他节点同步时间，启动服务并设置为开机启动；在compute 节点上指定controller 节点为上游NTP 服务器，重启服务并设为开机启动。</p>
<p>请在控制节点上使用chronyc 命令同步控制节点的系统时间。【1 分】</p>
<p><strong>Controller ：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">server 172.17.2.10 iburst</span></span><br><span class="line"><span class="string">allow all</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd --now</span><br></pre></td></tr></table></figure>

<p><strong>Compute：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">server 172.17.2.10 iburst</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd --now</span><br><span class="line">systemctl restart chronyd</span><br><span class="line">chronyc -a makestep</span><br></pre></td></tr></table></figure>

<h3 id="任务-2-OpenStack-搭建任务（10-分）"><a href="#任务-2-OpenStack-搭建任务（10-分）" class="headerlink" title="任务 2  OpenStack 搭建任务（10 分）"></a>任务 2  OpenStack 搭建任务（10 分）</h3><h4 id="1-修改变量文件"><a href="#1-修改变量文件" class="headerlink" title="1.修改变量文件"></a>1.修改变量文件</h4><p>在控制节点和计算节点上分别安装iaas-xiandian 软件包，修改配置脚本文件中基本变量（配置脚本文件为&#x2F;etc&#x2F;xiandian&#x2F;openrc.sh）。修改完成后使用命令生效该变量文件，然后执行 <code>echo $INTERFACE_IP</code> 命令。</p>
<p>请将命令和返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y iaas-xiandian</span><br></pre></td></tr></table></figure>

<p><strong>Controller:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手动填充剩余部分</span></span><br><span class="line">&gt; vim /etc/xiandian/openrc.sh</span><br><span class="line">	:%s/^<span class="comment">#//g</span></span><br><span class="line">	:%s/PASS=/PASS=000000/g</span><br><span class="line">&gt; <span class="built_in">source</span> /etc/xiandian/openrc.sh</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="variable">$INTERFACE_IP</span></span><br></pre></td></tr></table></figure>

<p><strong>Compute:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; scp /etc/xiandian/openrc.sh root@172.17.2.20:/etc/xiandian/openrc.sh</span><br><span class="line">&gt; vi /etc/xiandian/openrc.sh</span><br><span class="line">	:<span class="built_in">set</span> num</span><br><span class="line"><span class="comment"># 修改第69行的IP地址为Compute地址</span></span><br><span class="line">&gt; <span class="built_in">source</span> /etc/xiandian/openrc.sh</span><br><span class="line">&gt; <span class="built_in">echo</span> <span class="variable">$INTERFACE_IP</span></span><br></pre></td></tr></table></figure>

<h4 id="2-搭建数据库组件"><a href="#2-搭建数据库组件" class="headerlink" title="2.搭建数据库组件"></a>2.搭建数据库组件</h4><p>使用提供的脚本框架 iaas-install-mysql.sh ， 在controller 节点上安装 mariadb 、mencached、rabbitmq 等服务并完成相关配置。完成后修改配置文件将 mencached 最大连接数修改为2048。</p>
<p>请将修改后的配置文件提交到答题框。【1 分】</p>
<p><strong>controller &amp; compute：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iaas-pre-host.sh</span><br></pre></td></tr></table></figure>

<p><strong>controller ：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-mysql.sh</span><br><span class="line">sed -i <span class="string">&#x27;s/1024/2048/g&#x27;</span> /etc/sysconfig/memcached</span><br><span class="line">systemctl <span class="built_in">enable</span> memcached --now</span><br><span class="line">systemctl restart memcached</span><br><span class="line">ps -ef | grep memcached</span><br></pre></td></tr></table></figure>

<h4 id="3-搭建认证服务组件"><a href="#3-搭建认证服务组件" class="headerlink" title="3.搭建认证服务组件"></a>3.搭建认证服务组件</h4><p>使用提供的脚本框架 iaas-install-keystone.sh 填充脚本，在 controller 节点上安装 keystone 服务并完成相关配置。完成后使用 openstack 命令请求一个 token。</p>
<p>请将以上命令和返回结果提交到答题框。【1 分】</p>
<p><strong>controller ：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-keystone.sh</span><br><span class="line"><span class="built_in">source</span> /etc/keystone/admin-openrc.sh</span><br><span class="line">openstack token issue</span><br></pre></td></tr></table></figure>

<h4 id="4-搭建镜像服务组件"><a href="#4-搭建镜像服务组件" class="headerlink" title="4.搭建镜像服务组件"></a>4.搭建镜像服务组件</h4><p>使用提供的脚本框架 iaas-install-glance.sh 填充脚本，在 controller 节点上安装 glance 服务并完成相关配置。完成后请将 cirros-0.3.4-x86_64-disk.img 上传到控制节点的 &#x2F;root 目录下，然后使用 openstack 命令将该镜像上传到 openstack 平台镜像命名为 cirros。</p>
<p>请将镜像上传的操作命令和返回结果提交到答题框。【1 分】</p>
<p><strong>controller ：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-glance.sh</span><br><span class="line">scp cirros-0.3.4-x86_64-disk.img root@172.17.2.10:/root</span><br><span class="line">openstack image create --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare cirrors</span><br></pre></td></tr></table></figure>

<h4 id="5-搭建计算服务组件"><a href="#5-搭建计算服务组件" class="headerlink" title="5.搭建计算服务组件"></a>5.搭建计算服务组件</h4><p>使用提供的脚本框架 iaas-install-nova-controller.sh 和 iaas-install-nova-compute.sh 填充脚本，在 controller 和 compute 节点上安装 nova 服务并完成配置。完成后请将控制节点的计算资源也加入集群。然后使用 openstack 命令列出能提供计算资源的节点。</p>
<p>将列出计算资源的命令和返回结果提交到答题框。【1.5 分】</p>
<p><strong>controller：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-nova-controller.sh</span><br><span class="line">sed -i <span class="string">&#x27;s/#virt_type=kvm/virt_type=qemu/g&#x27;</span> /etc/nova/nova.conf</span><br><span class="line">systemctl restart *nova*</span><br><span class="line">openstack hypervisor list <span class="comment">#查看虚拟化节点列表</span></span><br><span class="line">openstack compute service list <span class="comment">#在控制节点查看计算服务的工作状态</span></span><br></pre></td></tr></table></figure>

<p><strong>compute：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-nova-compute.sh</span><br></pre></td></tr></table></figure>

<h4 id="6-搭建网络组件并初始化网络"><a href="#6-搭建网络组件并初始化网络" class="headerlink" title="6.搭建网络组件并初始化网络"></a>6.搭建网络组件并初始化网络</h4><p>使用提供的脚本框架 iaas-install-neutron-controller.sh 和 iaas-install-neutron-compute.sh，填充脚本，在controller 和compute 节点上安装neutron 服务并完成配置。创建云主机外部网络 ext-net，子网为 ext-subnet，云主机浮动IP 可用网段为172.18.x.100<del>172.18.x.200，网关为 172.18.x.1。创建云主机内部网络int-net1，子网为int-subnet1，云主机子网 IP 可用网段为 10.0.0.100</del>10.0.0.200，网关为 10.0.0.1；创建云主机内部网络int-net2，子网为 int-subnet2，云主机子网IP 可用网段为 10.0.1.100 ~ 10.0.1.200，网关为 10.0.1.1。添加名为 ext-router 的路由器，添加网关在ext-net 网络，添加内部端口到int-net1 网络，完成内部网络int-net1 和外部网络的连通。</p>
<p>请使用openstack 命令完成以下任务，完成后将命令和返回结果提交到答题框。【4 分】</p>
<p><strong>controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-neutron-controller.sh</span><br><span class="line">openstack network create --external ext-net</span><br><span class="line">openstack subnet create ext-subnet --network ext-net --gateway 172.18.2.1 --allocation-pool start=172.18.2.100,end=172.18.2.200 --subnet-range 172.18.2.0/16</span><br><span class="line">openstack network create int-net1</span><br><span class="line">openstack subnet create int-subnet --network int-net1 --gateway 10.0.0.1 --allocation-pool start=10.0.0.100,end=10.0.0.200 --subnet-range 10.0.0.0/24</span><br><span class="line">openstack network create int-net2</span><br><span class="line">openstack subnet create int-subnet --network int-net2 --gateway 10.0.1.1 --allocation-pool start=10.0.1.100,end=10.0.1.200 --subnet-range 10.0.1.0/24</span><br><span class="line">openstack router create ext-router</span><br><span class="line">openstack router add subnet ext-router int-subnet</span><br></pre></td></tr></table></figure>

<p><strong>compute</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-neutron-compute.sh</span><br></pre></td></tr></table></figure>

<h4 id="7-搭建图形化界面"><a href="#7-搭建图形化界面" class="headerlink" title="7.搭建图形化界面"></a>7.搭建图形化界面</h4><p>使用提供的脚本框架iaas-install-dashboard.sh，填充脚本，在controller 节点上安装 dashboard 服务并完成相关配置。</p>
<p>请使用 curl 指令获取 dashboard 首页信息，将获取到的首页信息提交到答题框。【1 分】</p>
<p><strong>controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-dashboard.sh</span><br><span class="line">curl http://172.17.2.10/dashboard/</span><br></pre></td></tr></table></figure>

<h3 id="任务-3-OpenStack-运维任务"><a href="#任务-3-OpenStack-运维任务" class="headerlink" title="任务 3  OpenStack 运维任务"></a>任务 3  OpenStack 运维任务</h3><h4 id="1-用户管理"><a href="#1-用户管理" class="headerlink" title="1.用户管理"></a>1.用户管理</h4><p>在keystone 中创建用户testuser，密码为password。创建好之后，使用命令修改 testuser 密码为 000000，并查看 testuser 的详细信息。添加将该用户添加到 admin 项目并赋予普通用户权限，完成后测试登录。</p>
<p>使用 testuser 用登录系统完成后截图并提交到答题框。【1 分】</p>
<p><strong>controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">openstack user create --domain demo --password password testuser</span><br><span class="line">openstack user <span class="built_in">set</span> --password 000000 testuser</span><br><span class="line">openstack user show testuser</span><br><span class="line">openstack role add --project admin --user testuser user</span><br></pre></td></tr></table></figure>

<h4 id="2-服务查询"><a href="#2-服务查询" class="headerlink" title="2.服务查询"></a>2.服务查询</h4><p>使用命令列出服务目录和端点，查看glance 服务的端点。将以上命令和返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openstack catalog list</span><br><span class="line">openstack catalog show glance</span><br></pre></td></tr></table></figure>

<h4 id="3-镜像管理"><a href="#3-镜像管理" class="headerlink" title="3.镜像管理"></a>3.镜像管理</h4><p>登录 controller 节点， 使用 glance 相关命令， 上传镜像， 源使用CentOS_6.5_x86_64_XD.qcow2，名字为 testone，然后使用 openstack 命令修改这个镜像名改为 examimage，然后给这个镜像打一个标签，标签名字为 lastone 改完后使用 openstack命令查看镜像列表。</p>
<p>将以上命令和返回结果提交到答题框。【2 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openstack image create --disk-format qcow2 --container-format bare --file CentOS_6.5_x86_64_XD.qcow2 --name testone</span><br><span class="line">openstack image <span class="built_in">set</span> --name examimage --tag lastone testone</span><br><span class="line">openstack image show examimage</span><br></pre></td></tr></table></figure>

<h4 id="4-后端配置文件管理"><a href="#4-后端配置文件管理" class="headerlink" title="4.后端配置文件管理"></a>4.后端配置文件管理</h4><p>进入到glance 后端存储目录中，使用 qemu 命令查看任意的一个镜像信息。使用du命令查看nova 主配置文件大小。</p>
<p>将以上命令和返回结果提交到答题框。【0.5 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/glance/images</span><br><span class="line">qemu-img info &lt;image-name&gt;</span><br><span class="line"><span class="built_in">du</span> /etc/nova/nova.conf	</span><br></pre></td></tr></table></figure>

<h4 id="5-存储服务管理"><a href="#5-存储服务管理" class="headerlink" title="5.存储服务管理"></a>5.存储服务管理</h4><p>创建一个卷类型，然后创建一块带这个卷类型标识的云硬盘，查询该云硬盘的详细信息。将该云硬盘挂载到虚拟机中，将该云硬盘格式化为xfs。创建一个文件文件名为工位号内容为工位号，然后将该云硬盘卸载，使用openstack 命令将该云硬盘修改为只读状态，再次挂载后查看是否存在原始文件，然后再次向该云硬盘中创建一个文件，文件名为工位号_02。</p>
<p>将返回结果及解题过程提交到答题框。【2 分】</p>
<p><strong>controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-cinder-controller.sh </span><br><span class="line">openstack volume create --<span class="built_in">type</span> lvm --size 1 unit</span><br><span class="line">openstack volume show unit</span><br><span class="line">openstack server create --image examimage --flavor m1.small --nic net-id=&lt;<span class="built_in">id</span>&gt; centos</span><br><span class="line">openstack server add unit examimage centos</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">openstack volume <span class="built_in">set</span> -read-only unit</span><br></pre></td></tr></table></figure>

<p><strong>compute</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iaas-install-cinder-compute.sh </span><br></pre></td></tr></table></figure>

<p><strong>centos</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkfs.xfs /dev/vdb</span><br><span class="line">mount /dev/vdb /mnt/</span><br><span class="line"><span class="built_in">touch</span> /mnt/2</span><br><span class="line">umount /dev/vdb</span><br></pre></td></tr></table></figure>

<h4 id="6-存储服务管理"><a href="#6-存储服务管理" class="headerlink" title="6.存储服务管理"></a>6.存储服务管理</h4><p>使用命令创建一个5GB 的云硬盘，名称为disk-2，将云硬盘挂载到云虚拟机内，然后格式化为ext4，挂载到虚拟机的&#x2F;mnt&#x2F; 目录下，使用df -h 将命令和返回信息提交到答题框。将该云硬盘使用命令卸载，使用命令将该云硬盘扩容到10GB，使用命令将云硬盘挂载到云主机上，将命令及返回信息提交到答题框。进入云主机使用命令扩容文件系统，扩容后再次挂载到&#x2F;mnt&#x2F;。</p>
<p>使用df -hT 命令并将命令和返回信息提交到答题框。【2 分】</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">openstack volume create --<span class="built_in">type</span> lvm --size 5 disk-2</span><br><span class="line">openstack server add disk-2 examimage centos</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">openstack server remove volume disk-2</span><br><span class="line">openstack volume <span class="built_in">set</span> disk-2 --size 10 </span><br><span class="line">openstack server add disk-2 examimage centos</span><br></pre></td></tr></table></figure>

<p><strong>centos</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;&lt;&lt;</span></span><br><span class="line">mkfs.ext4 /dev/vdb</span><br><span class="line">mount /dev/vdb /mnt/</span><br><span class="line"><span class="built_in">df</span> -Th</span><br><span class="line">umount /mnt/</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">mount /dev/vdb /mnt/</span><br><span class="line"><span class="built_in">df</span> -Th</span><br></pre></td></tr></table></figure>

<h4 id="7-对象存储管理"><a href="#7-对象存储管理" class="headerlink" title="7.对象存储管理"></a>7.对象存储管理</h4><p>使用swift 相关命令，创建一个容器，然后往这个容器中上传一个文件（文件可以自行创建），上传完毕后，使用命令查看容器。</p>
<p>将以上命令和返回结果提交到答题框。【0.5 分】</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">swift post <span class="built_in">test</span></span><br><span class="line">openstack container list</span><br><span class="line">swift upload <span class="built_in">test</span> &lt;filename&gt;</span><br><span class="line">openstack object show <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<h4 id="8-安全组管理"><a href="#8-安全组管理" class="headerlink" title="8.安全组管理"></a>8.安全组管理</h4><p>使用命令创建名称为 group_web 的安全组该安全组的描述为工位号，为该安全组添加一条规则允许任意ip 地址访问web 流量，完成后查看该安全组的详细信息。</p>
<p>将以上命令和返回结果提交到答题框。【2 分】	</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">openstack security group create group_web --description 2 </span><br><span class="line">openstack security group rule create rule1 --protocol tcp --egress </span><br><span class="line">openstack security group show group_web</span><br></pre></td></tr></table></figure>

<h4 id="9-网络管理"><a href="#9-网络管理" class="headerlink" title="9.网络管理"></a>9.网络管理</h4><p>使用命令将int-net1 网络设置为共享，然后查看int-net1 网络的详细信息。将命令和返回信息提交到答题框。【0.5 分】</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openstack network <span class="built_in">set</span> int-net1 --share</span><br><span class="line">openstack network show int-net1</span><br></pre></td></tr></table></figure>

<h4 id="10-网络管理"><a href="#10-网络管理" class="headerlink" title="10.网络管理"></a>10.网络管理</h4><p>使用 dashboard 界面使用 centos7.5 镜像创建一台云主机，云主机命名为 test-01，使用命令查看浮动IP 地址池，使用命令创建一个浮动IP，然后将浮动IP 绑定到云主机上。</p>
<p>将命令和返回信息提交到答题框。【1 分】</p>
<p><strong>Controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">openstack image create --disk-format qcow2 --container-format bare --file Centos-7.5.img net-centos</span><br><span class="line">openstack server create --image net-centos --flavor m1.medium --nic net-id=&lt;<span class="built_in">id</span>&gt; centos2</span><br><span class="line">openstack floating ip create ext-net</span><br><span class="line">openstack server add floating ip centos7.5 &lt;floating_ip&gt;</span><br></pre></td></tr></table></figure>

<h4 id="11-虚拟机管理"><a href="#11-虚拟机管理" class="headerlink" title="11.虚拟机管理"></a>11.虚拟机管理</h4><p>使用opentack 命令利用centos7.5 镜像创建一台云主机，连接int-net1 网络，云主机名称为test-02。创建成功后使用命令查看云主机详细信息，确定该云主机是处于计算节点还是控制节点。如果云主机处于控制节点上请将其冷迁移到计算节点，如果如果云主机处于计算节点上请将其冷迁移到控制节点。</p>
<p>本题全部流程请使用命令完成，请将全部命令和结果粘贴到答题框。【3 分】</p>
<p><strong>controller</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">openstack server create --image net-centos --flavor m1.medium --nic net-id=&lt;<span class="built_in">id</span>&gt; test-02</span><br><span class="line">openstack server show test-02</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">mysql -u root</span><br><span class="line">update instances <span class="built_in">set</span> host=<span class="string">&#x27;controller&#x27;</span>, node=<span class="string">&#x27;controller&#x27;</span> <span class="built_in">where</span> uuid=<span class="string">&#x27;&lt;sv-uuid&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>compute</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;&lt;&lt;</span></span><br><span class="line">scp /var/lib/nova/instances/&lt;sv&gt; Controller:/var/lib/nova/instances/</span><br></pre></td></tr></table></figure>

<h2 id="B-场次题目：容器的编排与运维"><a href="#B-场次题目：容器的编排与运维" class="headerlink" title="B 场次题目：容器的编排与运维"></a>B 场次题目：容器的编排与运维</h2><p>某企业计划使用k8s 平台搭建RuoYi 后台管理系统，以实现完成公司内部日常工作管理，例如OA 管理，用户管理，客户关系管理等业务。</p>
<table>
<thead>
<tr>
<th align="center">设备名称</th>
<th align="center">主机名</th>
<th align="center">接口</th>
<th align="center">IP 地址</th>
</tr>
</thead>
<tbody><tr>
<td align="center">云服务器1</td>
<td align="center">Master</td>
<td align="center">eth0</td>
<td align="center">10.0.0.100&#x2F;24</td>
</tr>
<tr>
<td align="center">云服务器2</td>
<td align="center">Node1</td>
<td align="center">eth0</td>
<td align="center">10.0.0.110&#x2F;24</td>
</tr>
<tr>
<td align="center">云服务器3</td>
<td align="center">Node2</td>
<td align="center">eth0</td>
<td align="center">10.0.0.120&#x2F;24</td>
</tr>
<tr>
<td align="center">云服务器4</td>
<td align="center">Harbor</td>
<td align="center">eth0</td>
<td align="center">10.0.0.130&#x2F;24</td>
</tr>
</tbody></table>
<h3 id="任务-1-容器云平台环境初始化（5-分）"><a href="#任务-1-容器云平台环境初始化（5-分）" class="headerlink" title="任务 1 容器云平台环境初始化（5 分）"></a>任务 1 容器云平台环境初始化（5 分）</h3><h4 id="1-容器云平台的初始化"><a href="#1-容器云平台的初始化" class="headerlink" title="1.容器云平台的初始化"></a>1.容器云平台的初始化</h4><p>根据表1 中的IP 地址规划，创建云服务器，镜像使用CentOS_7.5_x86_64_XD.qcow，确保网络正常通信。按照表1 设置主机名节点并关闭swap，同时永久关闭 selinux 以及防火墙,并修改hosts 映射。请将master 节点hosts 文件内容提交到答题框。【1 分】</p>
<p><strong>ALL</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">nmcli con add con-name ens32 ifname ens32 <span class="built_in">type</span> ethernet ipv4.address 10.0.0.100/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con up ens32</span><br><span class="line">nmcli con add con-name ens32 ifname ens32 <span class="built_in">type</span> ethernet ipv4.address 10.0.0.110/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con up ens32</span><br><span class="line">nmcli con add con-name ens32 ifname ens32 <span class="built_in">type</span> ethernet ipv4.address 10.0.0.120/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con up ens32</span><br><span class="line">nmcli con add con-name ens32 ifname ens32 <span class="built_in">type</span> ethernet ipv4.address 10.0.0.130/24 ipv4.method static autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli con up ens32</span><br><span class="line">hostnamectl set-hostname --static Master</span><br><span class="line">hostnamectl set-hostname --static Node1</span><br><span class="line">hostnamectl set-hostname --static Node2</span><br><span class="line">hostnamectl set-hostname --static Harbor</span><br><span class="line">swapoff -a</span><br><span class="line">sed -i <span class="string">&#x27;s|dev/mapper/centos-swap|#/dev/mapper/centos-swap|g&#x27;</span> /etc/fstab</span><br><span class="line"><span class="built_in">cat</span> /etc/fstab</span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/hosts &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">10.0.0.100 Master</span></span><br><span class="line"><span class="string">10.0.0.110 Node1</span></span><br><span class="line"><span class="string">10.0.0.120 Node2</span></span><br><span class="line"><span class="string">10.0.0.130 Harbor</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">setenforce 0</span><br><span class="line">sed -i <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27;</span> /etc/selinux/config</span><br><span class="line"><span class="built_in">cat</span> /etc/selinux/config |grep SELINUX=</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld --now</span><br></pre></td></tr></table></figure>

<h4 id="2-Yum-源数据的持久化挂载"><a href="#2-Yum-源数据的持久化挂载" class="headerlink" title="2.Yum 源数据的持久化挂载"></a>2.Yum 源数据的持久化挂载</h4><p>将提供的CentOS-7-x86_64-DVD-1804.iso 和chinaskills_cloud_paas.iso 光盘镜像上传到 master 节点&#x2F;root 目录下，然后在&#x2F;opt 目录下使用命令创建&#x2F;centos 目录和&#x2F;paas 目录，并将镜像文件CentOS-7-x86_64-DVD-1804.iso 挂载到&#x2F;centos 目录下， 将镜像文件 chinaskills_cloud_paas.iso 挂载到&#x2F;paas 目录下。</p>
<p>请设置永久开机自动挂载，并将设置的永久开机自动挂载的文件内容提交到答题框。【1分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /opt/centos /opt/paas</span><br><span class="line">mount CentOS-7-x86_64-DVD-1804.iso /opt/centos</span><br><span class="line">mount chinaskills_cloud_paas.iso /opt/paas</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;CentOS-7-x86_64-DVD-1804.iso /opt/centos&quot;</span> &gt;&gt; /etc/rc.local</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;mount chinaskills_cloud_paas.iso /opt/paas&quot;</span> &gt;&gt;/etc/rc.local</span><br></pre></td></tr></table></figure>

<h4 id="3-Yum-源的编写"><a href="#3-Yum-源的编写" class="headerlink" title="3.Yum 源的编写"></a>3.Yum 源的编写</h4><p>为master 节点设置本地yum 源，yum 源文件名为centos.repo，安装ftp 服务，将ftp 仓库设置为&#x2F;opt&#x2F;，为其他节点配置ftp 源，yum 源文件名称为ftp.repo，其中ftp 服务器地址为master 节点IP。</p>
<p>请将其它节点的yum 源文件内容提交到答题框。【1 分】</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/yum.repos.d/* /media/</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/yum.repos.d/centos.repo &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[centos]</span></span><br><span class="line"><span class="string">name=centos</span></span><br><span class="line"><span class="string">baseurl=file:///opt/centos</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">[paas]</span></span><br><span class="line"><span class="string">name=paas</span></span><br><span class="line"><span class="string">baseurl=file:///opt/paas/kubernetes-repo</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum install vsftpd vim bash-completion -y </span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/vsftpd/vsftpd.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">anon_root=/opt</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> vsftpd --now</span><br><span class="line">systemctl restart vsftpd</span><br></pre></td></tr></table></figure>

<p><strong>Others：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/yum.repos.d/* /media/</span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/yum.repos.d/ftp.repo &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">[centos]</span></span><br><span class="line"><span class="string">name=centos</span></span><br><span class="line"><span class="string">baseurl=ftp://Master/centos</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">[paas]</span></span><br><span class="line"><span class="string">name=paas</span></span><br><span class="line"><span class="string">baseurl=ftp://Master/paas/kubernetes-repo</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum repolist</span><br></pre></td></tr></table></figure>

<h4 id="4-设置时间同步服务器"><a href="#4-设置时间同步服务器" class="headerlink" title="4.设置时间同步服务器"></a>4.设置时间同步服务器</h4><p>在master 节点上部署chrony 服务器，允许其他节点同步时间，启动服务并设置为开机启动；在其他节点上指定master 节点为上游NTP 服务器，重启服务并设为开机启动。请在master 节点上使用chronyc 命令同步控制节点的系统时间。【1 分】</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">server Master iburst</span></span><br><span class="line"><span class="string">allow 10.0.0.0/24</span></span><br><span class="line"><span class="string">local stratum 10</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd --now</span><br><span class="line">systemctl restart chronyd</span><br></pre></td></tr></table></figure>

<p><strong>Others：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">server Master iburst</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">chronyc makestep</span><br></pre></td></tr></table></figure>

<h4 id="5-设置免密登录"><a href="#5-设置免密登录" class="headerlink" title="5.设置免密登录"></a>5.设置免密登录</h4><p>为四台服务器设置免密登录，保证3 台服务器能够互相免密登录。请使用scp 命令将master 节点的hosts 文件发送到所有节点的&#x2F;etc&#x2F;hosts。</p>
<p>将以上所有命令和返回结果提交到答题框。【1 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id root@Node1</span><br><span class="line">ssh-copy-id root@Node2</span><br><span class="line">ssh-copy-id root@Harbor</span><br><span class="line">scp /etc/hosts root@Node1:/root/hosts</span><br><span class="line">scp /etc/hosts root@Node2:/root/hosts</span><br><span class="line">scp /etc/hosts root@Harbor:/root/hosts</span><br></pre></td></tr></table></figure>

<h3 id="任务-2-k8s-搭建任务（10-分）"><a href="#任务-2-k8s-搭建任务（10-分）" class="headerlink" title="任务 2  k8s 搭建任务（10 分）"></a>任务 2  k8s 搭建任务（10 分）</h3><h4 id="1-安装-docker-应用"><a href="#1-安装-docker-应用" class="headerlink" title="1.安装 docker 应用"></a>1.安装 docker 应用</h4><p>在所有节点上安装 dokcer-ce。并在harbor 节点安装harbor 仓库，显现正常登录 horbor仓库，登录密码设置为“test_工位号”。</p>
<p>请将登录后截图提交到答题框。【1 分】</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker</span><br><span class="line">systemctl <span class="built_in">enable</span> docker --now</span><br><span class="line">scp /opt/paas/k8s_harbor_install.sh root@Harbor:/root</span><br><span class="line">scp -r /opt/paas/docker-compose root@Harbor:/opt</span><br><span class="line">scp -r /opt/paas/images root@Harbor:/opt</span><br><span class="line">scp -r /opt/paas/harbor root@Harbor:/opt</span><br></pre></td></tr></table></figure>

<p><strong>Node:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y docker-ce</span><br></pre></td></tr></table></figure>

<p><strong>Harbor：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;89i\</span></span><br><span class="line"><span class="string">\sed -i &quot;s/harbor_admin_password: Harbor12345/harbor_admin_password: test_02/g&quot; harbor.yml&#x27;</span> k8s_harbor_install.sh</span><br><span class="line">./k8s_harbor_install.sh</span><br></pre></td></tr></table></figure>

<h4 id="2．搭建-horbor-仓库"><a href="#2．搭建-horbor-仓库" class="headerlink" title="2．搭建 horbor 仓库"></a>2．搭建 horbor 仓库</h4><p>修改默认docker 仓库为harbor 地址，修改docker 启动引擎为systemd。安装完成后执行<code>docker verison</code> 命令返回结果以及将 daemon.json 文件内容提交。【2 分】</p>
<p><strong>ALL：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /etc/docker/daemon.json &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	&quot;insecure-registries&quot;:[&quot;10.0.0.130&quot;],</span></span><br><span class="line"><span class="string">	&quot;exec-opts&quot;:[&quot;native.cgroupdriver=systemd&quot;]</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">docker version</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<h4 id="3．安装-docker-compose"><a href="#3．安装-docker-compose" class="headerlink" title="3．安装 docker-compose"></a>3．安装 docker-compose</h4><p>在 master 节点上使用 &#x2F;opt&#x2F;paas&#x2F;docker-compose&#x2F;v1.25.5-docker-compose-Linux-x86_64 下的文件安装 docker-compose。安装完成后执行<code>docker-compose version</code> 命令，请将程序返回结果提交到答题框。【0.5 分】</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /opt/paas/docker-compose/v1.25.5-docker-compose-Linux-x86_64 /usr/local/bin/docker-compose</span><br><span class="line"><span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br><span class="line">docker-compose version</span><br></pre></td></tr></table></figure>

<h4 id="4．上传-docker-镜像"><a href="#4．上传-docker-镜像" class="headerlink" title="4．上传 docker 镜像"></a>4．上传 docker 镜像</h4><p>在master 节点使用&#x2F;opt&#x2F;paas&#x2F; k8s_image_push.sh 将所有镜像上传至docker 仓库。完成后将Harbor 仓库 library 中镜像列表截图，请将以上截图提交到答题框。【1 分】</p>
<p><strong>Master：</strong>（可替代的方案）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># scp /opt/paas/k8s_image_push.sh root@Harbor:/root/push.sh</span></span><br></pre></td></tr></table></figure>

<p><strong>Harbor：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `<span class="built_in">ls</span> /opt/images/`;<span class="keyword">do</span> docker image load -i <span class="variable">$i</span>;<span class="keyword">done</span>;</span><br><span class="line">docker image list</span><br></pre></td></tr></table></figure>

<h4 id="5．安装-kubeadm-工具"><a href="#5．安装-kubeadm-工具" class="headerlink" title="5．安装 kubeadm 工具"></a>5．安装 kubeadm 工具</h4><p>在master 及node 节点安装Kubeadm 工具并设置开机自动启动，安装完成后使用rpm命令配合grep 查看Kubeadm 工具是否正确安装。</p>
<p>将rpm 命令配合grep 返回结果提交到答题框。【0.5 分】</p>
<p><strong>Master：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum install -y kubeadm</span></span><br><span class="line"><span class="comment"># rpm -qa | grep kube</span></span><br><span class="line"><span class="built_in">cp</span> /opt/paas/k8s_master_install.sh master.sh</span><br><span class="line">scp /opt/paas/k8s_node_install.sh root@Node1:/root/node.sh</span><br><span class="line">scp /opt/paas/k8s_node_install.sh root@Node2:/root/node.sh</span><br><span class="line">./master.sh</span><br><span class="line"><span class="built_in">export</span> KUBERNETES_MASTER=master</span><br><span class="line">rpm -qa | grep kube</span><br></pre></td></tr></table></figure>

<p><strong>Node：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./node.sh</span><br><span class="line"><span class="built_in">export</span> KUBERNETES_MASTER=master</span><br></pre></td></tr></table></figure>

<h4 id="6．计算节点获取必备镜像"><a href="#6．计算节点获取必备镜像" class="headerlink" title="6．计算节点获取必备镜像"></a>6．计算节点获取必备镜像</h4><p>在所有node 节点中使用docker 命令拉取安装kubernetes 基础镜像，拉取完成后使用 docker 命令查看镜像列表。【1 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker pull 10.0.0.4/library/kube-apiserver:v1.18.1</span><br><span class="line">docker pull 10.0.0.4/library/kube-controller-manager:v1.18.1</span><br><span class="line">docker pull 10.0.0.4/library/kube-scheduler:v1.18.1</span><br><span class="line">docker pull 10.0.0.4/library/kube-proxy:v1.18.1</span><br><span class="line">docker pull 10.0.0.4/library/pause:3.2</span><br><span class="line">docker pull 10.0.0.4/library/etcd:3.4.3-0</span><br><span class="line">docker pull 10.0.0.4/library/coredns:1.6.7</span><br><span class="line">docker images list</span><br></pre></td></tr></table></figure>

<h4 id="7．kubeadm-安装-master"><a href="#7．kubeadm-安装-master" class="headerlink" title="7．kubeadm 安装 master"></a>7．kubeadm 安装 master</h4><p>使用 kubeadm 命令初始化 master 节点， 设置kubernetes 虚拟内部网段地址为10.244.0.0&#x2F;16，然后使用kube-flannel.yaml 完成控制节点初始化设置，完成后使用命令查看集群状态和所有pod</p>
<p><strong>Master：</strong>（可替代的方案）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># export KUBECONFIG=/etc/kubernetes/admin.conf</span></span><br><span class="line"><span class="comment"># source /etc/profile</span></span><br><span class="line"><span class="comment"># kubeadm init --kubernetes-version=1.18.1 --apiserver-advertise-address=192.168.20.10 --image-repository 10.0.0.130/library --pod-network-cidr=10.244.0.0/16</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl cluster-info </span><br><span class="line">kubectl get pods -A</span><br></pre></td></tr></table></figure>

<h4 id="8．安装-kubernetes-网络插件"><a href="#8．安装-kubernetes-网络插件" class="headerlink" title="8．安装 kubernetes 网络插件"></a>8．安装 kubernetes 网络插件</h4><p>使用 kube-flannel.yaml 安装 kubernetes 网络插件，安装完成后使用命令查看节点状态。完成后使用命令查看集群状态。</p>
<p>将集群状态查看命令和返回结果提交到答题框。【0.5 分】</p>
<p><strong>Master：</strong>（可替代的方案）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sed -i &quot;s/quay.io\/coreos/10.0.0.130\/library/g&quot; /opt/yaml/flannel/kube-flannel.yaml		# 需要修改</span></span><br><span class="line"><span class="comment"># kubectl apply -f /opt/yaml/flannel/kube-flannel.yaml</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl cluster-info </span><br></pre></td></tr></table></figure>

<h4 id="9．kubernetes-图形化界面的安装"><a href="#9．kubernetes-图形化界面的安装" class="headerlink" title="9．kubernetes 图形化界面的安装"></a>9．kubernetes 图形化界面的安装</h4><p>安装 kubernetes dashboard 界面，完成后查看首页然后将 kubernetes dashboard 界面截图提交到答题框。【1 分】</p>
<p><strong>Master：</strong>（可替代的方案）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir dashboard-certs</span></span><br><span class="line"><span class="comment"># cd dashboard-certs/</span></span><br><span class="line"><span class="comment"># kubectl create namespace kubernetes-dashboard</span></span><br><span class="line"><span class="comment"># openssl genrsa -out dashboard.key 2048</span></span><br><span class="line"><span class="comment"># openssl req -days 36000 -new -out dashboard.csr -key dashboard.key -subj &#x27;/CN=dashboard-cert&#x27;</span></span><br><span class="line"><span class="comment"># openssl x509 -req -in dashboard.csr -signkey dashboard.key -out dashboard.crt</span></span><br><span class="line"><span class="comment"># kubectl create secret generic kubernetes-dashboard-certs --from-file=dashboard.key --from-file=dashboard.crt -n kubernetes-dashboard</span></span><br><span class="line"><span class="comment"># sed -i &quot;s/kubernetesui/10.0.0.130\/library/g&quot; /opt/yaml/dashboard/recommended.yaml		#需要修改</span></span><br><span class="line"><span class="comment"># kubectl apply -f /opt/yaml/dashboard/recommended.yaml</span></span><br><span class="line"><span class="comment"># kubectl apply -f /opt/yaml/dashboard/dashboard-adminuser.yaml</span></span><br></pre></td></tr></table></figure>

<p><strong>Web：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;&gt; http://10.0.0.100</span></span><br><span class="line"><span class="comment"># 获取token</span></span><br><span class="line">kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep dashboard-admin | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="10．扩展计算节点"><a href="#10．扩展计算节点" class="headerlink" title="10．扩展计算节点"></a>10．扩展计算节点</h4><p>在master 节点上使用kubeadm 命令查看token，在所有node 节点上使用kubeadm 命令将node 节点加入kubernetes 集群。完成后在master 节点上查看所有节点状态。</p>
<p>将集群状态查看命令和返回结果提交到答题框。【0.5 分】</p>
<p><strong>Master：</strong>（可替代的方案）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubeadm token create --print-join-command</span><br><span class="line">kubeadm token list</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.20.10:6443 --token z636b2.aybrn1srspf8jgxl \</span><br><span class="line">    --discovery-token-ca-cert-hash sha256:2426de68ac6fa11b30d74fd73a9712c65e4df10729331a5dfc212da64de8c3b8 </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get node</span><br></pre></td></tr></table></figure>

<h3 id="任务三K8s-运维任务（15-分）"><a href="#任务三K8s-运维任务（15-分）" class="headerlink" title="任务三K8s 运维任务（15 分）"></a>任务三K8s 运维任务（15 分）</h3><h4 id="1-使用dockerfile-构建dokcer-镜像"><a href="#1-使用dockerfile-构建dokcer-镜像" class="headerlink" title="1.使用dockerfile 构建dokcer 镜像"></a>1.使用dockerfile 构建dokcer 镜像</h4><p>以 mysql:5.7 镜像为基础镜像，制作一个mysql 镜像，可以将提供的 sql 文件初始化到mysql 数据库中，然后使用编写的dockerfile 文件将镜像制作出来，名称为mysql:latest，并将该镜像上传至前面所搭建的 harbor 仓库中，编写 YAML 文件，验证数据库内容。</p>
<p>完成后将dockerfile 文件内容及harbor 仓库镜像列表、数据库内容提交到答题框。【1 分】</p>
<p><code>init.sql</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database `test`;</span><br><span class="line"><span class="keyword">SET</span> character_set_client <span class="operator">=</span> utf8;</span><br><span class="line">use test;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">`id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">primary</span> key,</span><br><span class="line">`name` <span class="type">varchar</span>(<span class="number">20</span>)</span><br><span class="line">)engine<span class="operator">=</span>innodb charset<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">mv</span> init.sql build/</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line"><span class="built_in">cat</span> &gt; Dockerfile &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">FROM 10.0.0.130/library/mysql:5.7</span></span><br><span class="line"><span class="string">MAINTAINER chinaskill</span></span><br><span class="line"><span class="string">WORKDIR /docker-entrypoint-initdb.d</span></span><br><span class="line"><span class="string">ENV LANG=C.UTF-8</span></span><br><span class="line"><span class="string">ADD init.sql .</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">docker build -t mysql:latest .</span><br><span class="line">docker push 10.0.0.130/library/mysql:latest</span><br></pre></td></tr></table></figure>

<h4 id="2-持久化存储"><a href="#2-持久化存储" class="headerlink" title="2.持久化存储"></a>2.持久化存储</h4><p>搭建 NFS 共享存储，配 置nfs-provisioner，创建 storageclass，通过storageclass 动态生成 pvc，大小为1Gi，修改标准 nfs-deployment.yaml 文件，编写 storageclass.yaml 和 pvc.yaml文件，将最终 pvc 状态截图和 yaml 文件提交至答题框。【2 分】</p>
<p><code>rbac.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>	</span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span>	</span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nfs-client-provisioner-runner</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">   <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumes&quot;</span>]</span><br><span class="line">   <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;watch&quot;</span>,<span class="string">&quot;create&quot;</span>,<span class="string">&quot;delete&quot;</span>]</span><br><span class="line"> <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">   <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumeclaims&quot;</span>]</span><br><span class="line">   <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;watch&quot;</span>,<span class="string">&quot;update&quot;</span>]</span><br><span class="line"> <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;storage.k8s.io&quot;</span>]</span><br><span class="line">   <span class="attr">resources:</span> [<span class="string">&quot;storageclasses&quot;</span>]</span><br><span class="line">   <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;watch&quot;</span>]</span><br><span class="line"> <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">   <span class="attr">resources:</span> [<span class="string">&quot;events&quot;</span>]</span><br><span class="line">   <span class="attr">verbs:</span> [<span class="string">&quot;create&quot;</span>,<span class="string">&quot;update&quot;</span>,<span class="string">&quot;patch&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span>	</span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">run-nfs-client-provisioner</span></span><br><span class="line"><span class="attr">subjects:</span>		</span><br><span class="line"> <span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">   <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line"> <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nfs-client-provisioner-runner</span></span><br><span class="line"> <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">   <span class="attr">resources:</span> [<span class="string">&quot;endpoints&quot;</span>]</span><br><span class="line">   <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;watch&quot;</span>,<span class="string">&quot;create&quot;</span>,<span class="string">&quot;update&quot;</span>,<span class="string">&quot;patch&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">RoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line"></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line"> <span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line"> <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br></pre></td></tr></table></figure>

<p><code>deployment.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line"> <span class="attr">selector:</span></span><br><span class="line">  <span class="attr">matchLabels:</span></span><br><span class="line">   <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line"> <span class="attr">template:</span></span><br><span class="line">  <span class="attr">metadata:</span></span><br><span class="line">   <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="attr">spec:</span> </span><br><span class="line">   <span class="attr">serviceAccountName:</span> <span class="string">nfs-client-provisioner</span>		</span><br><span class="line">   <span class="attr">containers:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">     <span class="attr">image:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.130</span><span class="string">/library/nfs-client-provisioner</span></span><br><span class="line">     <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">     <span class="attr">volumeMounts:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-root</span></span><br><span class="line">       <span class="attr">mountPath:</span> <span class="string">/persistentvolumes</span></span><br><span class="line">     <span class="attr">env:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">PROVISIONER_NAME</span></span><br><span class="line">       <span class="attr">value:</span> <span class="string">nfs-client</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">NFS_SERVER</span></span><br><span class="line">       <span class="attr">value:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.100</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">NFS_PATH</span></span><br><span class="line">       <span class="attr">value:</span> <span class="string">/root/nfs</span></span><br><span class="line">   <span class="attr">volumes:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-root</span></span><br><span class="line">     <span class="attr">nfs:</span></span><br><span class="line">      <span class="attr">server:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.100</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/root/nfs</span></span><br></pre></td></tr></table></figure>

<p><code>storageclass.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">storage-test</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">nfs-client</span></span><br></pre></td></tr></table></figure>

<p><code>pvc.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">pvc</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">accessModes:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line"> <span class="attr">resources:</span></span><br><span class="line">  <span class="attr">requests:</span></span><br><span class="line">   <span class="attr">storage:</span> <span class="string">1Gi</span></span><br><span class="line"> <span class="attr">storageClassName:</span> <span class="string">storage-test</span>		</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">yum -y install nfs-utils</span><br><span class="line">systemctl <span class="built_in">enable</span> rpcbind nfs --now</span><br><span class="line"><span class="built_in">mkdir</span> nfs</span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/exports &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">/root/nfs 10.0.0.0/24(rw,sync,no_root_squash)		</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">exportfs -v</span><br><span class="line">exportfs -r</span><br><span class="line">showmount -e localhost</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">kubectl apply -f rbac.yml</span><br><span class="line">kubectl apply -f deployment.yaml</span><br><span class="line">kubectl apply -f storageclass.yaml</span><br><span class="line">kubectl apply -f pvc.yaml</span><br><span class="line"></span><br><span class="line">kubectl get deployment </span><br><span class="line">kubectl get pvc</span><br></pre></td></tr></table></figure>

<h4 id="3-编写deployment-文件"><a href="#3-编写deployment-文件" class="headerlink" title="3.编写deployment 文件"></a>3.编写deployment 文件</h4><p>将提供的nginx:latest 镜像上传至harbor 镜像仓库，使用该镜像编写deployment 文件，要求将已创建的pvc 挂载至&#x2F;html 目录下，副本数1，实现资源限制:需求内存300Mi，需求CPU 300M，限制内存450Mi，限制CPU450M，将POD 状态截图和yaml 文件提交至答题框。【3 分】</p>
<p><code>nginx-deployment.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span> </span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line"> <span class="attr">selector:</span></span><br><span class="line">  <span class="attr">matchLabels:</span></span><br><span class="line">   <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">template:</span> </span><br><span class="line">  <span class="attr">metadata:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">   <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">spec:</span></span><br><span class="line">   <span class="attr">containers:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">     <span class="attr">image:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.130</span><span class="string">/library/nginx:latest</span></span><br><span class="line">     <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">     <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">container-port</span></span><br><span class="line">       <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">     <span class="attr">resources:</span>			</span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">       <span class="attr">memory:</span> <span class="string">300Mi</span></span><br><span class="line">       <span class="attr">cpu:</span> <span class="string">300m</span> </span><br><span class="line">      <span class="attr">limits:</span></span><br><span class="line">       <span class="attr">memory:</span> <span class="string">450Mi</span></span><br><span class="line">       <span class="attr">cpu:</span> <span class="string">450m</span></span><br><span class="line">   <span class="attr">volumes:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pvc</span></span><br><span class="line">     <span class="attr">persistentVolumeClaim:</span>		</span><br><span class="line">      <span class="attr">claimName:</span> <span class="string">pvc</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kuectl apply -f nginx-deployment.yml</span><br><span class="line">kubectl get pods -n default</span><br></pre></td></tr></table></figure>

<h4 id="4-创建-service-服务，提供对外访问接口"><a href="#4-创建-service-服务，提供对外访问接口" class="headerlink" title="4.创建 service 服务，提供对外访问接口"></a>4.创建 service 服务，提供对外访问接口</h4><p>基于nginx 的 pod 服务，编写一个service 名称为 nginx-svc，代理 nginx 的服务端口，端口类型为 nodeport，创建成功后可以通过该 service 访问nginx。完成后提交 yaml 文件及访问截图至答题框。【3 分】</p>
<p><code>service.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">selector:</span></span><br><span class="line">  <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">ports:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">   <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line">   <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line"> <span class="attr">type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure>

<p><code>pod.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">labels:</span></span><br><span class="line">  <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">containers:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">   <span class="attr">image:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.130</span><span class="string">/library/nginx:latest</span></span><br><span class="line">   <span class="attr">ports:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f service.yml</span><br><span class="line">kubectl apply -f pod.yml</span><br><span class="line">kubectl get pod -n default -o wide</span><br><span class="line">kubectl get svc </span><br><span class="line">curl &lt;ip:port&gt;</span><br></pre></td></tr></table></figure>

<h4 id="5-配置metrics-server-实现资源监控"><a href="#5-配置metrics-server-实现资源监控" class="headerlink" title="5.配置metrics-server 实现资源监控"></a>5.配置metrics-server 实现资源监控</h4><p>将已提供的metrics-server 镜像上传至harbor，修改components.yaml，创建 metrics-server，完成后，将 metrics-server 状态截图提交至答题框。【2 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml</span><br><span class="line"><span class="comment"># 修改components.yaml文件，搜索image，将image地址改为harbor仓库地址</span></span><br><span class="line"><span class="comment"># 在args参数下添加</span></span><br><span class="line">	- --kubelet-preferred-address-types=InternalIP </span><br><span class="line">	- --kubelet-insecure-tls</span><br><span class="line"></span><br><span class="line">kubectl get pods -A | grep  metrics-server</span><br><span class="line">vim /etc/kubernetes/manifests/kube-apiserver.yaml </span><br><span class="line">	- --enable-aggregator-routing=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line">kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml</span><br><span class="line">systemctl restart kubelet</span><br><span class="line">kubectl get pod -n kube-system | grep metrics-server</span><br><span class="line">kubectl describe svc metrics-server -n kube-system</span><br><span class="line">kubectl get pods -A | grep  metrics-server</span><br></pre></td></tr></table></figure>

<h4 id="6-配置弹性伸缩"><a href="#6-配置弹性伸缩" class="headerlink" title="6.配置弹性伸缩"></a>6.配置弹性伸缩</h4><p>编写deployment-nginx-hpa.yaml 文件，要求最小副本数1，最大副本数3，当整体的资源利用率超过80%的时候实现自动扩容，将yaml 文件提交至答题框。【2 分】</p>
<p><code>deployment-nginx-pod.yaml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">autoscaling/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">HorizontalPodAutoscaler</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx-hpa</span></span><br><span class="line"><span class="attr">spec:</span> </span><br><span class="line"> <span class="attr">maxReplicas:</span> <span class="number">3</span>		</span><br><span class="line"> <span class="attr">minReplicas:</span> <span class="number">1</span>		</span><br><span class="line"> <span class="attr">scaleTargetRef:</span>	</span><br><span class="line">  <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">targetCPUUtilizationPercentage:</span> <span class="number">80</span>		</span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">selector:</span></span><br><span class="line">  <span class="attr">matchLabels:</span></span><br><span class="line">   <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"> <span class="attr">template:</span></span><br><span class="line">  <span class="attr">metadata:</span></span><br><span class="line">   <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">   <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">spec:</span></span><br><span class="line">   <span class="attr">containers:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">     <span class="attr">image:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.130</span><span class="string">/library/nginx:latest</span></span><br><span class="line">     <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">     <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">requests:</span></span><br><span class="line">       <span class="attr">cpu:</span> <span class="string">250m</span></span><br><span class="line">       <span class="attr">memory:</span> <span class="string">300Mi</span>       </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f deployment-nginx-pod.yaml</span><br><span class="line">kubectl scale deployment nginx --replicas=5</span><br><span class="line">kubectl get pods</span><br><span class="line"><span class="comment"># Max 3</span></span><br><span class="line">kubectl get hpa</span><br><span class="line">NAME        REFERENCE          TARGETS   MINPODS   MAXPODS   REPLICAS</span><br><span class="line">nginx-hpa   Deployment/nginx   0%/80%    1         3         3</span><br></pre></td></tr></table></figure>

<h4 id="7-压力测试"><a href="#7-压力测试" class="headerlink" title="7.压力测试"></a>7.压力测试</h4><p>安装httpd-tools 工具，通过service 提供的对外访问接口进行压力测试，验证HPA 弹性伸缩功能，将HPA 状态和POD 状态截图提交至答题框。【2 分】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install httpd-tools</span><br><span class="line">ab -t 600 -n 1000000 -c 1000 &lt;ip:port&gt;</span><br><span class="line">kubectl get hpa</span><br><span class="line">kubectl get pod</span><br></pre></td></tr></table></figure>

<h2 id="C-场次题目：企业级应用的自动化部署和运维"><a href="#C-场次题目：企业级应用的自动化部署和运维" class="headerlink" title="C 场次题目：企业级应用的自动化部署和运维"></a>C 场次题目：企业级应用的自动化部署和运维</h2><table>
<thead>
<tr>
<th>主机名</th>
<th>IP地址</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>Master</td>
<td>私有云下发</td>
<td>Prometheus,grafana,ansible</td>
</tr>
<tr>
<td>Node1</td>
<td>私有云下发</td>
<td>agent</td>
</tr>
<tr>
<td>Node2</td>
<td>私有云下发</td>
<td>agent</td>
</tr>
</tbody></table>
<h3 id="任务1-企业级应用的自动化部署（15-分）"><a href="#任务1-企业级应用的自动化部署（15-分）" class="headerlink" title="任务1 企业级应用的自动化部署（15 分）"></a>任务1 企业级应用的自动化部署（15 分）</h3><h4 id="1-ansible-自动化运维工具的安装【3-分】"><a href="#1-ansible-自动化运维工具的安装【3-分】" class="headerlink" title="1.ansible 自动化运维工具的安装【3 分】"></a>1.ansible 自动化运维工具的安装【3 分】</h4><p>请使用提供的软件包在master 节点安装ansible，安装完成后使用 <code>ansible --version</code> 命令验证是否安装成功。为所有节点添加 test 用户，设置用户密码为000000。为test 用户设置免密sudo，配置ssh 免密登录，使master 节点能够免密登录所有节点的test 用户。</p>
<p>将<code>ansible --version</code> 命令和回显粘贴到答题框。</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">yum install ansible -y</span><br><span class="line">useradd <span class="built_in">test</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;000000&quot;</span> | passwd --stdin <span class="built_in">test</span></span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/sudoers &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">test		ALL=(ALL) NOPASSWD: ALL</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id <span class="built_in">test</span>@Node1</span><br><span class="line">ssh-copy-id <span class="built_in">test</span>@Node2</span><br><span class="line">ssh-copy-id <span class="built_in">test</span>@Master</span><br><span class="line">ansible --version</span><br></pre></td></tr></table></figure>

<p><strong>Node1:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useradd <span class="built_in">test</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;000000&quot;</span> passwd --stdin <span class="built_in">test</span></span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/sudoers &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">test		ALL=(ALL) NOPASSWD: ALL</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p><strong>Node2:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">useradd <span class="built_in">test</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;000000&quot;</span> passwd --stdin <span class="built_in">test</span></span><br><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/sudoers &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">test		ALL=(ALL) NOPASSWD: ALL</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<h4 id="2-ansible-自动化运维工具的初始化【3-分】"><a href="#2-ansible-自动化运维工具的初始化【3-分】" class="headerlink" title="2.ansible 自动化运维工具的初始化【3 分】"></a>2.ansible 自动化运维工具的初始化【3 分】</h4><p>创建 &#x2F;root&#x2F;ansible 目录作为工作目录，在该目录内创建 ansible.cfg 文件并完成以下配置，清单文件位置为 &#x2F;root&#x2F;ansible&#x2F;inventory，登录用户为test，登录时不需要输入密码。设置并行主机数量为 2，允许 test 用户免密提权到 root。<br>将 ansible.cfg 文件内容粘贴到答题框。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /root/ansible</span><br><span class="line"><span class="built_in">cd</span> ansible</span><br><span class="line"><span class="built_in">cat</span> &gt; ansible.cfg &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[defaults]</span></span><br><span class="line"><span class="string">inventory = /root/ansible/inventory</span></span><br><span class="line"><span class="string">remote_user = test</span></span><br><span class="line"><span class="string">ask_pass = false</span></span><br><span class="line"><span class="string">forks = 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[privilege_escalation]</span></span><br><span class="line"><span class="string">become = true</span></span><br><span class="line"><span class="string">become_user = root</span></span><br><span class="line"><span class="string">become_method = sudo</span></span><br><span class="line"><span class="string">become_ask_pass = false</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<h4 id="3-主机清单的编写【2-分】"><a href="#3-主机清单的编写【2-分】" class="headerlink" title="3.主机清单的编写【2 分】"></a>3.主机清单的编写【2 分】</h4><p>编写主机清单文件，创建 master 用户组，master 用户组内添加 master 主机；创建node用户组，node 组内添加node1 和node2 主机，主机名不得使用 IP 地址。</p>
<p>完成后执行<code>ansible-inventory --list</code> 、<code>ansible all -m ping</code> 和<code>ansible all -a &quot;id&quot;</code> 命令，将这三条命令返回结果粘贴到答题框。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; inventory &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[master]</span></span><br><span class="line"><span class="string">Master</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[node]</span></span><br><span class="line"><span class="string">Node1</span></span><br><span class="line"><span class="string">Node2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ansible-inventory --list</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;_meta&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hostvars&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;all&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;children&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;master&quot;</span>, </span><br><span class="line">            <span class="string">&quot;node&quot;</span>, </span><br><span class="line">            <span class="string">&quot;ungrouped&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;master&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hosts&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;Master&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;node&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hosts&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;Node1&quot;</span>, </span><br><span class="line">            <span class="string">&quot;Node2&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m ping</span><br><span class="line">Node1 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Node2 | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Master | SUCCESS =&gt; &#123;</span><br><span class="line">    <span class="string">&quot;ansible_facts&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;discovered_interpreter_python&quot;</span>: <span class="string">&quot;/usr/bin/python&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;changed&quot;</span>: <span class="literal">false</span>, </span><br><span class="line">    <span class="string">&quot;ping&quot;</span>: <span class="string">&quot;pong&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ansible all -a <span class="string">&quot;id&quot;</span></span><br><span class="line">Node2 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) 组=0(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">Node1 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) 组=0(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">Master | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">uid=0(root) gid=0(root) 组=0(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure>

<h4 id="4-使用自动化工具对-master-节点进行初始化【2-分】"><a href="#4-使用自动化工具对-master-节点进行初始化【2-分】" class="headerlink" title="4.使用自动化工具对 master 节点进行初始化【2 分】"></a>4.使用自动化工具对 master 节点进行初始化【2 分】</h4><p>请编写 prometheus.yml 控制 master 主机组，使用对应模块将 SELinux 临时状态和开机启动状态也设置为 disabled。请使用 ansible 对应模块安装时间同步服务，使用文本编辑模块将该服务的作用域设置为 0.0.0.0&#x2F;0，并设置状态为启动和开机自动启动。首先将提供的 prometheus-2.37.0.linux-amd64.tar.gz 使用文件拷贝模块将该压缩包拷贝到目标主机的 &#x2F;usr&#x2F;local&#x2F; 下，使用 shell 模块解压该压缩包。</p>
<p><code>prometheus.yml</code></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&#x27;Init Master&#x27;</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">master</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">package:</span> <span class="string">chrony</span></span><br><span class="line">      <span class="attr">svc:</span> <span class="string">chronyd</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Disable</span> <span class="string">SELinux</span></span><br><span class="line">      <span class="attr">selinux:</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">disabled</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Chrony</span></span><br><span class="line">      <span class="attr">yum:</span></span><br><span class="line">        <span class="attr">name:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; package &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">latest</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Configure</span> <span class="string">chrony</span></span><br><span class="line">      <span class="attr">lineinfile:</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/etc/chrony.conf</span></span><br><span class="line">        <span class="attr">line:</span> <span class="string">&#x27;allow 0.0.0.0/0&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">set</span> <span class="string">chrony</span> <span class="string">service</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; svc &#125;&#125;</span>&quot;</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">CP</span> <span class="string">file</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">src:</span> <span class="string">&#x27;prometheus-2.37.0.linux-amd64.tar.gz&#x27;</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">&#x27;/usr/local/prometheus-2.37.0.linux-amd64.tar.gz&#x27;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">uzip</span> <span class="string">file</span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">&#x27;tar -zxvf /usr/local/prometheus-2.37.0.linux-amd64.tar.gz chdir=/usr/local/&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@Master ansible]<span class="comment"># ansible-playbook prometheus.yml </span></span><br><span class="line"></span><br><span class="line">PLAY [Init Master] *********************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [Diable SELinux] *********************************************************************************************************************</span><br><span class="line">[WARNING]: SELinux state change will take effect next reboot</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [Install Chrony] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [Configure chrony] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [<span class="built_in">set</span> chrony service] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [CP file] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">TASK [uzip file] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">PLAY RECAP *********************************************************************************************************************</span><br><span class="line">Master                     : ok=7    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 </span><br></pre></td></tr></table></figure>

<h4 id="5-使用自动化运维工具完成企业级应用的部署【5-分】"><a href="#5-使用自动化运维工具完成企业级应用的部署【5-分】" class="headerlink" title="5.使用自动化运维工具完成企业级应用的部署【5 分】"></a>5.使用自动化运维工具完成企业级应用的部署【5 分】</h4><p>编写 prometheus.yml.j2 模板文件，将所有 node 节点信息添加到该文件中，但是被管节点的主机名信息必须使用变量 IP 地址可以手动输入。</p>
<p>完成后请创建node_exporter.yml 文件，编写第一个play，将该play 命名为 node，该 play 控制的主机组为 node。使用ansible 模块将node_exporter-1.3.1.linux-amd64.tar.gz 发送到 node 主机组的 &#x2F;usr&#x2F;local&#x2F; 下，使用一个shell模块解压该压缩包，并启动该服务。</p>
<p>随后编写第二个 play，将第二个 play 命名为 master，第二个 play 控制 master 节点。首先使用 ansible 模块将 prometheus.yml.j2 文件传输到master 节点，然后使用 script 模块将 prometheus 启动。使用对应模块将 grafana-8.1.2-1.x86_64.rpm 包发送到被控节点的 &#x2F;mnt&#x2F; 目录下，然后使用对应模块将该软件包安装，安装完成后设置 grafana 服务启动并设置开机自动启动。</p>
<p>使用浏览器登录 prometheus 查看 prometheus 是否成功监控所有 node 节点。<br>请将浏览器反馈的结果截图、prometheus.yml.j2 文件的内容、node_exporter.yml 文件内容及运行结果提交到答题框。</p>
<p><code>start.sh</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="built_in">nohup</span> /usr/local/prometheus-2.37.0.linux-amd64/prometheus --config.file=prometheus.yml --web.enable-lifecycle 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<p><code>prometheus.yml.j2</code> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set node1_ipadd = &quot;10.0.0.110&quot; %&#125;</span><br><span class="line">&#123;% set node2_ipadd = &quot;10.0.0.120&quot; %&#125;</span><br><span class="line">global:</span><br><span class="line">  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.</span><br><span class="line">  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.</span><br><span class="line">  # scrape_timeout is set to the global default (10s).</span><br><span class="line"></span><br><span class="line">alerting:</span><br><span class="line">  alertmanagers:</span><br><span class="line">    - static_configs:</span><br><span class="line">        - targets:</span><br><span class="line">          # - alertmanager:9093</span><br><span class="line"></span><br><span class="line">rule_files:</span><br><span class="line">  # - &quot;first_rules.yml&quot;</span><br><span class="line">  # - &quot;second_rules.yml&quot;</span><br><span class="line"></span><br><span class="line">scrape_configs:</span><br><span class="line">  - job_name: &quot;node&quot;</span><br><span class="line">    static_configs:</span><br><span class="line">     - targets: [&quot;&#123;&#123; node1_ipadd &#125;&#125;:9100&quot;,&quot;&#123;&#123; node2_ipadd &#125;&#125;:9100&quot;]</span><br></pre></td></tr></table></figure>

<p><code>node_exporter.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">node</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">node</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">file</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">          <span class="attr">src:</span> <span class="string">node_exporter-1.3.1.linux-amd64.tar.gz</span></span><br><span class="line">          <span class="attr">dest:</span> <span class="string">/usr/local/node_exporter-1.3.1.linux-amd64.tar.gz</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">uzip</span> <span class="string">file</span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">&quot;tar -zxvf /usr/local/node_exporter-1.3.1.linux-amd64.tar.gz chdir=/usr/local/&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">boot</span> <span class="string">node_exp</span></span><br><span class="line">      <span class="attr">shell:</span> <span class="string">&quot;nohup /usr/local/node_exporter-1.3.1.linux-amd64/node_exporter 2&gt;&amp;1 &amp;&quot;</span></span><br><span class="line">   </span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">master</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">master</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">touch</span> <span class="string">yml</span></span><br><span class="line">      <span class="attr">template:</span></span><br><span class="line">        <span class="attr">src:</span> <span class="string">prometheus.yml.j2</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/usr/local/prometheus-2.37.0.linux-amd64/prometheus.yml</span></span><br><span class="line">    </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">start</span> <span class="string">prometheus</span></span><br><span class="line">      <span class="attr">script:</span> <span class="string">start.sh</span></span><br><span class="line">        </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">file</span></span><br><span class="line">      <span class="attr">copy:</span></span><br><span class="line">        <span class="attr">src:</span>  <span class="string">grafana-8.1.2-1.x86_64.rpm</span></span><br><span class="line">        <span class="attr">dest:</span> <span class="string">/mnt/</span></span><br><span class="line">     </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">grafana</span></span><br><span class="line">      <span class="attr">yum:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">/mnt/grafana-8.1.2-1.x86_64.rpm</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line">       </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">service</span> <span class="string">configure</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">grafana-server</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook node_exporter.yml</span><br><span class="line">PLAY [node] *********************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] *********************************************************************************************************************</span><br><span class="line">ok: [Node2]</span><br><span class="line">ok: [Node1]</span><br><span class="line"></span><br><span class="line">TASK [copy file] *********************************************************************************************************************</span><br><span class="line">ok: [Node2]</span><br><span class="line">ok: [Node1]</span><br><span class="line"></span><br><span class="line">TASK [uzip file] *********************************************************************************************************************</span><br><span class="line">changed: [Node2]</span><br><span class="line">changed: [Node1]</span><br><span class="line"></span><br><span class="line">TASK [boot node_exp] *********************************************************************************************************************</span><br><span class="line">changed: [Node1]</span><br><span class="line">changed: [Node2]</span><br><span class="line"></span><br><span class="line">PLAY [master] *********************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [<span class="built_in">touch</span> yml] *********************************************************************************************************************</span><br><span class="line">ok: [Master]</span><br><span class="line"></span><br><span class="line">TASK [start prometheus] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">TASK [copy file] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">TASK [install grafana] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">TASK [service configure] *********************************************************************************************************************</span><br><span class="line">changed: [Master]</span><br><span class="line"></span><br><span class="line">PLAY RECAP *********************************************************************************************************************</span><br><span class="line">Master                     : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">Node1                      : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">Node2                      : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>

<h3 id="任务2-企业级应用的运维（12-分）"><a href="#任务2-企业级应用的运维（12-分）" class="headerlink" title="任务2 企业级应用的运维（12 分）"></a>任务2 企业级应用的运维（12 分）</h3><h4 id="1-使用prometheus-监控mysqld-服务【3-分】"><a href="#1-使用prometheus-监控mysqld-服务【3-分】" class="headerlink" title="1.使用prometheus 监控mysqld 服务【3 分】"></a>1.使用prometheus 监控mysqld 服务【3 分】</h4><p>将提供的 mysqld_exporter-0.14.0.linux-amd64.tar.gz 发送到 agent 虚拟机 &#x2F;usr&#x2F;local&#x2F; 目录下解压并安装 mariadb 服务。进入mariadb 数据库中创建mysqld_monitor 用户并授权，然后创建mariadb 配置文件，内容为数据库用户名密码。启动 mysqld_exporter 组件确保9104 端口启动。回到prometheus 节点修改prometheus.yml 文件并添加mysql 被监控信息。重启prometheus，随后web 界面刷新并查看mysqld 被控信息。<br>将以上操作提交到答题框。</p>
<p><strong>Master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">scp mysqld_exporter-0.14.0.linux-amd64.tar.gz root@Node1:/usr/local/</span><br><span class="line">scp mysqld_exporter-0.14.0.linux-amd64.tar.gz root@Node2:/usr/local/</span><br><span class="line"><span class="comment"># Attached `/usr/local/prometheus-2.37.0.linux-amd64/prometheus.yml` </span></span><br><span class="line">  - job_name: <span class="string">&quot;mysql&quot;</span></span><br><span class="line">    static_configs:</span><br><span class="line">     - targets: [<span class="string">&quot;10.0.0.110:9104&quot;</span>,<span class="string">&quot;10.0.0.120:9104&quot;</span>]</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line"><span class="built_in">cd</span> /usr/local/prometheus-2.37.0.linux-amd64</span><br><span class="line"><span class="built_in">chmod</span> +x pro_start.sh</span><br><span class="line">./pro_start.sh</span><br></pre></td></tr></table></figure>

<p><strong>Node:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yum -y install mariadb mariadb-server</span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb --now</span><br><span class="line">mysqladmin -u root password</span><br><span class="line"></span><br><span class="line">mysql -uroot -p000000</span><br><span class="line">use <span class="built_in">test</span>;</span><br><span class="line">grant replication client,process on *.* to <span class="string">&#x27;mysql_monitor&#x27;</span>@localhost identified by <span class="string">&#x27;mysql_monitor&#x27;</span>;</span><br><span class="line">grant <span class="keyword">select</span> on *.* to mysql_monitor@localhost;</span><br><span class="line">quit</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /usr/local/</span><br><span class="line">tar -zxvf mysqld_exporter-0.14.0.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">touch</span> /usr/local/mysqld_exporter-0.14.0.linux-amd64/my.cnf</span><br><span class="line"><span class="built_in">cat</span> &gt; /root/.my.cnf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[client]</span></span><br><span class="line"><span class="string">user=mysql_monitor</span></span><br><span class="line"><span class="string">password=mysql_monitor</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">/usr/local/mysqld_exporter-0.14.0.linux-amd64/mysqld_exporter</span><br></pre></td></tr></table></figure>

<p><code>pro_start.sh</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /applog/prometheus &amp;&amp; <span class="built_in">touch</span>  /applog/prometheus/prometheus.log</span><br><span class="line"><span class="built_in">nohup</span> ./prometheus --config.file=prometheus.yml --web.enable-lifecycle &gt; /applog/prometheus/prometheus.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h4 id="2-安装alertmanager-报警组件【3-分】"><a href="#2-安装alertmanager-报警组件【3-分】" class="headerlink" title="2.安装alertmanager 报警组件【3 分】"></a>2.安装alertmanager 报警组件【3 分】</h4><p>将提供的alertmanager-0.21.0.linux-amd64.tar.gz 上传到prometheus 节点&#x2F;usr&#x2F;local&#x2F; 目录下并解压，创建软连接alertmanager-0.23.0.linux-amd64&#x2F; alertmanager。</p>
<p>创建service 启动文件，然后启动alertmanager 查看9093 端口。在prometheus.yml 配置文件中添加alertmanager 信息并重新启动prometheus 服务，在agent 上停止node_exporter 服务。到web 界面中查看警报管理器状态是否正常和agent 状态是否异常。<br>将操作命令及截图提交到答题框。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local</span><br><span class="line">tar -zxvf alertmanager-0.21.0.linux-amd64.tar.gz </span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/alertmanager-0.21.0.linux-amd64/alertmanager.yml /root/</span><br></pre></td></tr></table></figure>

<p><code>alertmanager.service</code> </p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[unit]</span></span><br><span class="line"><span class="attr">Description</span>=alertmanager</span><br><span class="line"><span class="attr">After</span>=network.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">User</span>=root</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/local/alertmanager-<span class="number">0.21</span>.<span class="number">0</span>.linux-amd64/alertmanager --storage.path=/usr/local/alertmanager-<span class="number">0.21</span>.<span class="number">0</span>.linux-amd64/data --config.file=/root/alertmanager.yml</span><br><span class="line"><span class="attr">Restart</span>=<span class="literal">on</span>-failure</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=mutli-user.target</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> alertmanager.service /lib/systemd/system/</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl <span class="built_in">enable</span> alertmanager --now</span><br><span class="line">ss -ntlp |grep 9093</span><br><span class="line"><span class="comment"># Changed `/usr/local/prometheus-2.37.0.linux-amd64/prometheus.yml` </span></span><br><span class="line">alerting:</span><br><span class="line">  alertmanagers:</span><br><span class="line">    - static_configs:</span><br><span class="line">        - targets:</span><br><span class="line">          - alertmanager:9093</span><br><span class="line"><span class="comment"># &gt;&gt;&gt;</span></span><br><span class="line">  - job_name: <span class="string">&#x27;Altertmanager&#x27;</span></span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [<span class="string">&#x27;192.168.200.200:9093&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p><code>live.rules</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">HighErrorRate</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">promhttp_metric_handler_requests_total&#123;code!=&quot;200&quot;,</span> <span class="string">instance=&quot;192.168.200.201:9100&quot;,</span> <span class="string">job=&quot;node&quot;&#125;</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">10m</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">page</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">Service</span> <span class="string">downed</span> <span class="string">latency</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">node_exporter</span> <span class="string">svc</span> <span class="string">is</span> <span class="string">dead</span></span><br></pre></td></tr></table></figure>

<h4 id="3-alertmanager-告警邮件文件编写【3-分】"><a href="#3-alertmanager-告警邮件文件编写【3-分】" class="headerlink" title="3.alertmanager 告警邮件文件编写【3 分】"></a>3.alertmanager 告警邮件文件编写【3 分】</h4><p>Prometheus 虚拟机<code>/usr/local/alertmanager/</code> 中存在着一个alertmanager.yml 文件，请根据提供的地址和模板编写告警所发送到的email 邮箱地址信息。<br>将配置文件中编写的内容提交到答题框。</p>
<p><code>alertmanager.yml</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">resolve_timeout:</span> <span class="string">5m</span></span><br><span class="line">  <span class="attr">smtp_smarthost:</span> <span class="string">&#x27;smtp.qq.com:465&#x27;</span></span><br><span class="line">  <span class="attr">smtp_from:</span> <span class="string">&#x27;&lt;qq&gt;@qq.com&#x27;</span></span><br><span class="line">  <span class="attr">smtp_auth_username:</span> <span class="string">&#x27;&lt;qq&gt;@qq.com&#x27;</span></span><br><span class="line">  <span class="attr">smtp_auth_password:</span> <span class="string">&quot;&lt;pwd&gt;&quot;</span></span><br><span class="line">  <span class="attr">smtp_require_tls:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">route:</span></span><br><span class="line">  <span class="attr">group_by:</span> [<span class="string">&#x27;alertname&#x27;</span>]</span><br><span class="line">  <span class="attr">group_wait:</span> <span class="string">10s</span></span><br><span class="line">  <span class="attr">group_interval:</span> <span class="string">10s</span></span><br><span class="line">  <span class="attr">repeat_interval:</span> <span class="string">1h</span></span><br><span class="line">  <span class="attr">receiver:</span> <span class="string">&#x27;email&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">receivers:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&#x27;email&#x27;</span></span><br><span class="line">  <span class="attr">email_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">to:</span> <span class="string">&#x27;&lt;qq&gt;@qq.com&#x27;</span></span><br><span class="line">  <span class="attr">webhook_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">&#x27;http://127.0.0.1:5001/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">inhibit_rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">source_match:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">&#x27;critical&#x27;</span></span><br><span class="line">    <span class="attr">target_match:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">    <span class="attr">equal:</span> [<span class="string">&#x27;alertname&#x27;</span>, <span class="string">&#x27;dev&#x27;</span>, <span class="string">&#x27;instance&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="4-alertmanager-告警规则编写【3-分】"><a href="#4-alertmanager-告警规则编写【3-分】" class="headerlink" title="4.alertmanager 告警规则编写【3 分】"></a>4.alertmanager 告警规则编写【3 分】</h4><p>在prometheus 虚拟机的prometheus 路径下存在一个&#x2F;rules 目录， 目录下有一个node_rules.yml 文件。请根据提供信息仿照模板编写：</p>
<ol>
<li>内存大于50%报警规则；</li>
<li>cpu 资源利用率大于75%报警规则；</li>
<li>主机磁盘每秒读取数据&gt;50MB报警规则；</li>
</ol>
<p>部门名称可为工位号，将配置文件内容提交到答题框。</p>
<p><code>node_rules.yml</code> </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">alertmanager_pod.rules</span></span><br><span class="line">  <span class="attr">rules:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">Pod_all_cpu_usage</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">(sum</span> <span class="string">by(name)(rate(container_cpu_usage_seconds_total&#123;image!=&quot;&quot;&#125;[5m]))*100)</span> <span class="string">&gt;</span> <span class="number">75</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">2m</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">critical</span></span><br><span class="line">      <span class="attr">service:</span> <span class="string">pods</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">容器</span> &#123;&#123; <span class="string">$labels.name</span> &#125;&#125; <span class="string">CPU</span> <span class="string">资源利用率大于</span> <span class="number">75</span><span class="string">%</span> <span class="string">,</span> <span class="string">(current</span> <span class="string">value</span> <span class="string">is</span> &#123;&#123; <span class="string">$value</span> &#125;&#125;<span class="string">)</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;Dev CPU 负载告警&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">主机内存使用率告警</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">(1</span> <span class="bullet">-</span> <span class="string">(node_memory_MemAvailable_bytes</span> <span class="string">/</span> <span class="string">(node_memory_MemTotal_bytes)))</span> <span class="string">*</span> <span class="number">100</span> <span class="string">&gt;</span> <span class="number">50</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">2m</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;内存利用率大于50%, 实例: <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>，当前值：<span class="template-variable">&#123;&#123; $value &#125;&#125;</span>%&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">UnusualDiskReadRate</span></span><br><span class="line">    <span class="attr">expr:</span> <span class="string">sum</span> <span class="string">by</span> <span class="string">(instance)</span> <span class="string">(irate(node_disk_bytes_read[2m]))</span> <span class="string">/</span> <span class="number">1024</span> <span class="string">/</span> <span class="number">1024</span> <span class="string">&gt;</span> <span class="number">50</span></span><br><span class="line">    <span class="attr">for:</span> <span class="string">2m</span></span><br><span class="line">    <span class="attr">labels:</span></span><br><span class="line">      <span class="attr">severity:</span> <span class="string">warning</span></span><br><span class="line">    <span class="attr">annotations:</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">&quot;Unusual disk read rate (instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>)&quot;</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">&quot;高负载：磁盘正在读取大量数据 (&gt; 50 MB/s) (current value: <span class="template-variable">&#123;&#123; $value &#125;&#125;</span>)&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="任务-3-企业级微服务运维（13-分）"><a href="#任务-3-企业级微服务运维（13-分）" class="headerlink" title="任务 3 企业级微服务运维（13 分）"></a>任务 3 企业级微服务运维（13 分）</h3><h4 id="1-在K8S-集群安装istio【4-分】"><a href="#1-在K8S-集群安装istio【4-分】" class="headerlink" title="1.在K8S 集群安装istio【4 分】"></a>1.在K8S 集群安装istio【4 分】</h4><p>将istio-1.10.1-linux-amd64.tar 上传至master 节点并解压至&#x2F;root 目录下，将&#x2F;istio 目录内容器镜像文件上传至各node 节点中并且加载，完成istio 初始化安装，将部署成功后三台POD状态截图提交答题框。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf istio-1.10.1-linux-amd64.tar.gz </span><br><span class="line"><span class="built_in">cp</span> istio-1.10.1/bin/istioctl /usr/local/bin/istioctl</span><br><span class="line">istioctl install --<span class="built_in">set</span> profile=demo -y</span><br></pre></td></tr></table></figure>

<h4 id="2-部署基于在线书店bookinfo【6-分】"><a href="#2-部署基于在线书店bookinfo【6-分】" class="headerlink" title="2.部署基于在线书店bookinfo【6 分】"></a>2.部署基于在线书店bookinfo【6 分】</h4><p>Bookinfo 是一个在线书店微服务应用，Bookinfo 应用分为四个单独的微服务：</p>
<ol>
<li><p>productpage。这个微服务会调用details 和reviews 两个微服务，用来生成页面。</p>
</li>
<li><p>details。这个微服务中包含了书籍的信息。</p>
</li>
<li><p>reviews。这个微服务中包含了书籍相关的评论。它还会调用ratings 微服务。</p>
</li>
<li><p>ratings。这个微服务中包含了由书籍评价组成的评级信息。</p>
</li>
</ol>
<p>reviews 微服务有3 个版本：v1 版本不会调用ratings 服务；</p>
<p>v2 版本会调用ratings服务，并使用1 到5 个黑色星形图标来显示评分信息；v3 版本会调用ratings 服务，并使用1 到5 个红色星形图标来显示评分信息。</p>
<p>实现该应用服务网格的部署，利用Istio 控制平面为应用提供服务路由、监控数据收集以及策略实施等功能。部署架构如下：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="C:\Users\xerat\AppData\Roaming\Typora\typora-user-images\image-20230331132914752.png" alt="image-20230331132914752"></p>
<ol>
<li>编写Dockerfile 构建productpage:v1.0 镜像，具体要求如下：<ul>
<li>基础镜像：centos:7.9.2009；</li>
<li>安装Python3.6.8 工具；</li>
<li>安装productpage 服务并设置开机自启。</li>
</ul>
</li>
<li>规划应用微服务部署架构，在容器集群中通过修改微服务应用的yaml 文件来完成bookinfo 微服务应用的部署。</li>
<li>在容器集群中设置熔断规则，对Bookinfo 其中的productpage 微服务设置熔断规则，并通过负载fortio 测试客户端触发熔断机制进行验证。</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Change image source url</span></span><br><span class="line">kubectl apply -f bookinfo/bookinfo.yaml</span><br></pre></td></tr></table></figure>

<h4 id="3-部署网关接口实现对外服务【3-分】"><a href="#3-部署网关接口实现对外服务【3-分】" class="headerlink" title="3.部署网关接口实现对外服务【3 分】"></a>3.部署网关接口实现对外服务【3 分】</h4><p>通过 <code>istio-1.10.1/samples/bookinfo/networking/bookinfo-gateway.yaml</code> 部署bookinfo 网关，通过外部浏览器登陆 bookinfo，请将浏览器反馈的结果截图提交答题框。</p>
<p><code>bookinfo-gateway.yaml</code> </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Gateway</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">bookinfo-gateway</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">istio:</span> <span class="string">ingressgateway</span></span><br><span class="line">  <span class="attr">servers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span></span><br><span class="line">      <span class="attr">number:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">HTTP</span></span><br><span class="line">    <span class="attr">hosts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">networking.istio.io/v1alpha3</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">VirtualService</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">bookinfo</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">  <span class="attr">gateways:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">bookinfo-gateway</span></span><br><span class="line">  <span class="attr">http:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">match:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">exact:</span> <span class="string">/productpage</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">/static</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">exact:</span> <span class="string">/login</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">exact:</span> <span class="string">/logout</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uri:</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">/api/v1/products</span></span><br><span class="line">    <span class="attr">route:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">destination:</span></span><br><span class="line">        <span class="attr">host:</span> <span class="string">productpage</span></span><br><span class="line">        <span class="attr">port:</span></span><br><span class="line">          <span class="attr">number:</span> <span class="number">9080</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f bookinfo-gateway.yaml</span><br><span class="line">kubectl get gateways.networking.istio.io   </span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Zelas2Xerath</div><div class="post-copyright__author_desc">技术苑</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.806006.xyz/2023/03/01/BRICS-FS-11/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://blog.806006.xyz/2023/03/01/BRICS-FS-11/')">BRICS-FS-11_云计算赛项样题</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.806006.xyz/2023/03/01/BRICS-FS-11/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=BRICS-FS-11_云计算赛项样题&amp;url=https://blog.806006.xyz/2023/03/01/BRICS-FS-11/&amp;pic=https://s2.loli.net/2022/06/15/FCSyTrh1zm9JoUN.jpg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.806006.xyz" target="_blank">HugeH4rD</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/ChinaSkills/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ChinaSkills<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>云计算<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E9%87%91%E7%A0%96/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>金砖<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E6%A0%B7%E9%A2%98/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>样题<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>职业技能大赛<span class="tagsPageCount">2</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/06/18/HxoXm2wUsZBnubR.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/02/27/DIY230227/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/10/tXpAnWv1zHBfYMI.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">[23年3月抢先版] DIYer‘s Home 冲击最佳装机月</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/31/AWX/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/10/DOXhRetckmozqyF.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Ansible GUI 管理工具 AWX</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>猜你喜欢</span></div><div class="relatedPosts-list"><div><a href="/2023/04/01/Ex2/" title="一带一路暨金砖国家技能赛 - 云计算赛项样题"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/18/HxoXm2wUsZBnubR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-04-01</div><div class="title">一带一路暨金砖国家技能赛 - 云计算赛项样题</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar" title="点击展开"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">运维、开发、后端</b>相关的问题和看法。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Zelas2Xerath</h1><div class="author-info__desc">技术苑</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/zelas2xerath" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/324690213" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">2023/8/24-跟进上游更新 Bug fix </div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://npm.elemecdn.com/hexo-lib@1.0.22/img/face.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://npm.elemecdn.com/hexo-lib@1.0.22/img/back.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022-%E5%B9%B4%E9%87%91%E7%A0%96%E5%9B%BD%E5%AE%B6%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9BBRICS-FS-11-%E4%BA%91%E8%AE%A1%E7%AE%97%E8%B5%9B%E9%A1%B9%E6%A0%B7%E9%A2%98"><span class="toc-text">2022 年金砖国家职业技能大赛BRICS-FS-11_云计算赛项样题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-%E5%9C%BA%E6%AC%A1%E9%A2%98%E7%9B%AE%EF%BC%9AOpenStack-%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-text">A 场次题目：OpenStack  平台部署与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1-%E7%A7%81%E6%9C%89%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%885-%E5%88%86%EF%BC%89"><span class="toc-text">任务 1 私有云平台环境初始化（5 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-text">1.初始化操作系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8C%82%E8%BD%BD%E5%AE%89%E8%A3%85%E5%85%89%E7%9B%98%E9%95%9C%E5%83%8F"><span class="toc-text">2.挂载安装光盘镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%BE%E7%BD%AE-yum-%E6%BA%90"><span class="toc-text">3.设置 yum 源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">4.搭建文件共享服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E9%83%A8%E7%BD%B2%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">5.部署时间同步服务器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-2-OpenStack-%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1%EF%BC%8810-%E5%88%86%EF%BC%89"><span class="toc-text">任务 2  OpenStack 搭建任务（10 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E5%8F%98%E9%87%8F%E6%96%87%E4%BB%B6"><span class="toc-text">1.修改变量文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%90%AD%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%84%E4%BB%B6"><span class="toc-text">2.搭建数据库组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-text">3.搭建认证服务组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%90%AD%E5%BB%BA%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-text">4.搭建镜像服务组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%90%AD%E5%BB%BA%E8%AE%A1%E7%AE%97%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6"><span class="toc-text">5.搭建计算服务组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%90%AD%E5%BB%BA%E7%BD%91%E7%BB%9C%E7%BB%84%E4%BB%B6%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E7%BD%91%E7%BB%9C"><span class="toc-text">6.搭建网络组件并初始化网络</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2"><span class="toc-text">7.搭建图形化界面</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-3-OpenStack-%E8%BF%90%E7%BB%B4%E4%BB%BB%E5%8A%A1"><span class="toc-text">任务 3  OpenStack 运维任务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text">1.用户管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9C%8D%E5%8A%A1%E6%9F%A5%E8%AF%A2"><span class="toc-text">2.服务查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86"><span class="toc-text">3.镜像管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="toc-text">4.后端配置文件管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">5.存储服务管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%AD%98%E5%82%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-text">6.存储服务管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-text">7.对象存储管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%AE%89%E5%85%A8%E7%BB%84%E7%AE%A1%E7%90%86"><span class="toc-text">8.安全组管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86"><span class="toc-text">9.网络管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86"><span class="toc-text">10.网络管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AE%A1%E7%90%86"><span class="toc-text">11.虚拟机管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-%E5%9C%BA%E6%AC%A1%E9%A2%98%E7%9B%AE%EF%BC%9A%E5%AE%B9%E5%99%A8%E7%9A%84%E7%BC%96%E6%8E%92%E4%B8%8E%E8%BF%90%E7%BB%B4"><span class="toc-text">B 场次题目：容器的编排与运维</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-1-%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%885-%E5%88%86%EF%BC%89"><span class="toc-text">任务 1 容器云平台环境初始化（5 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%B9%E5%99%A8%E4%BA%91%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">1.容器云平台的初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Yum-%E6%BA%90%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E6%8C%82%E8%BD%BD"><span class="toc-text">2.Yum 源数据的持久化挂载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Yum-%E6%BA%90%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-text">3.Yum 源的编写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">4.设置时间同步服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AE%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95"><span class="toc-text">5.设置免密登录</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-2-k8s-%E6%90%AD%E5%BB%BA%E4%BB%BB%E5%8A%A1%EF%BC%8810-%E5%88%86%EF%BC%89"><span class="toc-text">任务 2  k8s 搭建任务（10 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85-docker-%E5%BA%94%E7%94%A8"><span class="toc-text">1.安装 docker 应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%BC%8E%E6%90%AD%E5%BB%BA-horbor-%E4%BB%93%E5%BA%93"><span class="toc-text">2．搭建 horbor 仓库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%BC%8E%E5%AE%89%E8%A3%85-docker-compose"><span class="toc-text">3．安装 docker-compose</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%EF%BC%8E%E4%B8%8A%E4%BC%A0-docker-%E9%95%9C%E5%83%8F"><span class="toc-text">4．上传 docker 镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%EF%BC%8E%E5%AE%89%E8%A3%85-kubeadm-%E5%B7%A5%E5%85%B7"><span class="toc-text">5．安装 kubeadm 工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6%EF%BC%8E%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9%E8%8E%B7%E5%8F%96%E5%BF%85%E5%A4%87%E9%95%9C%E5%83%8F"><span class="toc-text">6．计算节点获取必备镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7%EF%BC%8Ekubeadm-%E5%AE%89%E8%A3%85-master"><span class="toc-text">7．kubeadm 安装 master</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8%EF%BC%8E%E5%AE%89%E8%A3%85-kubernetes-%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6"><span class="toc-text">8．安装 kubernetes 网络插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9%EF%BC%8Ekubernetes-%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-text">9．kubernetes 图形化界面的安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10%EF%BC%8E%E6%89%A9%E5%B1%95%E8%AE%A1%E7%AE%97%E8%8A%82%E7%82%B9"><span class="toc-text">10．扩展计算节点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E4%B8%89K8s-%E8%BF%90%E7%BB%B4%E4%BB%BB%E5%8A%A1%EF%BC%8815-%E5%88%86%EF%BC%89"><span class="toc-text">任务三K8s 运维任务（15 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8dockerfile-%E6%9E%84%E5%BB%BAdokcer-%E9%95%9C%E5%83%8F"><span class="toc-text">1.使用dockerfile 构建dokcer 镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8"><span class="toc-text">2.持久化存储</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%BC%96%E5%86%99deployment-%E6%96%87%E4%BB%B6"><span class="toc-text">3.编写deployment 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA-service-%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%8F%90%E4%BE%9B%E5%AF%B9%E5%A4%96%E8%AE%BF%E9%97%AE%E6%8E%A5%E5%8F%A3"><span class="toc-text">4.创建 service 服务，提供对外访问接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E9%85%8D%E7%BD%AEmetrics-server-%E5%AE%9E%E7%8E%B0%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7"><span class="toc-text">5.配置metrics-server 实现资源监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E9%85%8D%E7%BD%AE%E5%BC%B9%E6%80%A7%E4%BC%B8%E7%BC%A9"><span class="toc-text">6.配置弹性伸缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95"><span class="toc-text">7.压力测试</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-%E5%9C%BA%E6%AC%A1%E9%A2%98%E7%9B%AE%EF%BC%9A%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E5%92%8C%E8%BF%90%E7%BB%B4"><span class="toc-text">C 场次题目：企业级应用的自动化部署和运维</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A11-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%EF%BC%8815-%E5%88%86%EF%BC%89"><span class="toc-text">任务1 企业级应用的自动化部署（15 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-ansible-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">1.ansible 自动化运维工具的安装【3 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ansible-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">2.ansible 自动化运维工具的初始化【3 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%BB%E6%9C%BA%E6%B8%85%E5%8D%95%E7%9A%84%E7%BC%96%E5%86%99%E3%80%902-%E5%88%86%E3%80%91"><span class="toc-text">3.主机清单的编写【2 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B7%A5%E5%85%B7%E5%AF%B9-master-%E8%8A%82%E7%82%B9%E8%BF%9B%E8%A1%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%902-%E5%88%86%E3%80%91"><span class="toc-text">4.使用自动化工具对 master 节点进行初始化【2 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7%E5%AE%8C%E6%88%90%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E9%83%A8%E7%BD%B2%E3%80%905-%E5%88%86%E3%80%91"><span class="toc-text">5.使用自动化运维工具完成企业级应用的部署【5 分】</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A12-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%BF%90%E7%BB%B4%EF%BC%8812-%E5%88%86%EF%BC%89"><span class="toc-text">任务2 企业级应用的运维（12 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8prometheus-%E7%9B%91%E6%8E%A7mysqld-%E6%9C%8D%E5%8A%A1%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">1.使用prometheus 监控mysqld 服务【3 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85alertmanager-%E6%8A%A5%E8%AD%A6%E7%BB%84%E4%BB%B6%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">2.安装alertmanager 报警组件【3 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-alertmanager-%E5%91%8A%E8%AD%A6%E9%82%AE%E4%BB%B6%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">3.alertmanager 告警邮件文件编写【3 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-alertmanager-%E5%91%8A%E8%AD%A6%E8%A7%84%E5%88%99%E7%BC%96%E5%86%99%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">4.alertmanager 告警规则编写【3 分】</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1-3-%E4%BC%81%E4%B8%9A%E7%BA%A7%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4%EF%BC%8813-%E5%88%86%EF%BC%89"><span class="toc-text">任务 3 企业级微服务运维（13 分）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9C%A8K8S-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85istio%E3%80%904-%E5%88%86%E3%80%91"><span class="toc-text">1.在K8S 集群安装istio【4 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%83%A8%E7%BD%B2%E5%9F%BA%E4%BA%8E%E5%9C%A8%E7%BA%BF%E4%B9%A6%E5%BA%97bookinfo%E3%80%906-%E5%88%86%E3%80%91"><span class="toc-text">2.部署基于在线书店bookinfo【6 分】</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%83%A8%E7%BD%B2%E7%BD%91%E5%85%B3%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E5%AF%B9%E5%A4%96%E6%9C%8D%E5%8A%A1%E3%80%903-%E5%88%86%E3%80%91"><span class="toc-text">3.部署网关接口实现对外服务【3 分】</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/04/01/Ex2/" title="一带一路暨金砖国家技能赛 - 云计算赛项样题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/18/HxoXm2wUsZBnubR.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一带一路暨金砖国家技能赛 - 云计算赛项样题"/></a><div class="content"><a class="title" href="/2023/04/01/Ex2/" title="一带一路暨金砖国家技能赛 - 云计算赛项样题">一带一路暨金砖国家技能赛 - 云计算赛项样题</a><time datetime="2023-04-01T14:00:00.000Z" title="发表于 2023-04-01 22:00:00">2023-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/31/AWX/" title="Ansible GUI 管理工具 AWX"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/10/DOXhRetckmozqyF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Ansible GUI 管理工具 AWX"/></a><div class="content"><a class="title" href="/2023/03/31/AWX/" title="Ansible GUI 管理工具 AWX">Ansible GUI 管理工具 AWX</a><time datetime="2023-03-31T14:00:00.000Z" title="发表于 2023-03-31 22:00:00">2023-03-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/01/BRICS-FS-11/" title="BRICS-FS-11_云计算赛项样题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/15/FCSyTrh1zm9JoUN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BRICS-FS-11_云计算赛项样题"/></a><div class="content"><a class="title" href="/2023/03/01/BRICS-FS-11/" title="BRICS-FS-11_云计算赛项样题">BRICS-FS-11_云计算赛项样题</a><time datetime="2023-03-01T14:00:00.000Z" title="发表于 2023-03-01 22:00:00">2023-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/27/DIY230227/" title="[23年3月抢先版] DIYer‘s Home 冲击最佳装机月"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/10/tXpAnWv1zHBfYMI.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[23年3月抢先版] DIYer‘s Home 冲击最佳装机月"/></a><div class="content"><a class="title" href="/2023/02/27/DIY230227/" title="[23年3月抢先版] DIYer‘s Home 冲击最佳装机月">[23年3月抢先版] DIYer‘s Home 冲击最佳装机月</a><time datetime="2023-02-27T01:00:00.000Z" title="发表于 2023-02-27 09:00:00">2023-02-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/02/python-man/" title="手动编译安装 python"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2022/06/13/qLBwxPklc5oX42D.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="手动编译安装 python"/></a><div class="content"><a class="title" href="/2023/02/02/python-man/" title="手动编译安装 python">手动编译安装 python</a><time datetime="2023-02-02T14:00:00.000Z" title="发表于 2023-02-02 22:00:00">2023-02-02</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:leancode@189.cn" title="email"><i class="anzhiyufont anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/leancode" title="微博"><i class="anzhiyufont anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100078912407411" title="facebook"><i class="anzhiyufont anzhiyufont anzhiyu-icon-facebook1"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/zelas2xerath" title="Github"><i class="anzhiyufont anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/324690213" title="Bilibili"><i class="anzhiyufont anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/ipyraW4/" title="抖音"><i class="anzhiyufont anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="网盘" target="_blank" rel="noopener" href="https://pan.806006.xyz/">网盘</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">板块</div><div class="footer-links"><a class="footer-item" title="OpenWrt" href="/Openwrt/">OpenWrt</a><a class="footer-item" title="PWN" href="/Pwn/">PWN</a><a class="footer-item" title="逆向" href="/Reverse/">逆向</a><a class="footer-item" title="网络" href="/Net/">网络</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a><a class="footer-item" title="好物清单" href="/equipment/">好物清单</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/bottom.svg" alt="距离上市也就还差一个小目标~" title="距离上市也就还差一个小目标~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title="博客框架为Hexo"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/Hexo.svg" alt="博客框架为Hexo"/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题 Anzhiyu" title="主题 Anzhiyu"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/Theme.svg" alt="主题 Anzhiyu"/></a><a class="github-badge" target="_blank" href="https://sm.ms/" style="margin-inline:5px" data-title="本站图床由 SM.MS 提供" title="本站图床由 SM.MS 提供"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/DrawingBed.svg" alt="本站图床由 SM.MS 提供"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="https://cloud.tencent.com/" style="margin-inline:5px" data-title="本站由 Serverless Framework 构建" title="本站由 Serverless Framework 构建"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/Serverless.svg" alt="本站由 Serverless Framework 构建"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/hexo-lib@1.0.22/svg/Copyright.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2018 - 2023 By <a class="footer-bar-link" href="/" title="Zelas2Xerath" target="_blank">Zelas2Xerath</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#footer-type-tips", {
      strings: ["寒江孤影&#44;江湖故人&#44;相逢何必曾相识."],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("footer-type-tips").innerHTML = '寒江孤影&#44;江湖故人&#44;相逢何必曾相识.'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.0.15/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="浙ICP备2022018228">浙ICP备2022018228</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 板块</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Openwrt/"><i class="fa-solid fa-wifi faa-tada"></i><span> OpenWrt</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Pwn/"><i class="fa-solid fa-0 faa-tada"></i><span> Pwn</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Reverse/"><i class="fa-brands fa-500px faa-tada"></i><span> Reverse</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/Net/"><i class="fa-brands fa-battle-net faa-tada"></i><span> Net</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 好物清单</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/NET/" style="font-size: 0.88rem;">.NET<sup>1</sup></a><a href="/tags/AMD/" style="font-size: 0.88rem;">AMD<sup>1</sup></a><a href="/tags/AWX/" style="font-size: 0.88rem;">AWX<sup>1</sup></a><a href="/tags/ChinaSkills/" style="font-size: 0.88rem;">ChinaSkills<sup>2</sup></a><a href="/tags/DIY/" style="font-size: 0.88rem;">DIY<sup>1</sup></a><a href="/tags/DirectX/" style="font-size: 0.88rem;">DirectX<sup>1</sup></a><a href="/tags/GPU/" style="font-size: 0.88rem;">GPU<sup>1</sup></a><a href="/tags/IDA/" style="font-size: 0.88rem;">IDA<sup>1</sup></a><a href="/tags/KVM/" style="font-size: 0.88rem;">KVM<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 0.88rem;">Markdown<sup>1</sup></a><a href="/tags/Office/" style="font-size: 0.88rem;">Office<sup>1</sup></a><a href="/tags/Openwrt/" style="font-size: 0.88rem;">Openwrt<sup>8</sup></a><a href="/tags/Potplayer/" style="font-size: 0.88rem;">Potplayer<sup>1</sup></a><a href="/tags/Pwn/" style="font-size: 0.88rem;">Pwn<sup>1</sup></a><a href="/tags/Python/" style="font-size: 0.88rem;">Python<sup>1</sup></a><a href="/tags/RHCE/" style="font-size: 0.88rem;">RHCE<sup>1</sup></a><a href="/tags/RHCSA/" style="font-size: 0.88rem;">RHCSA<sup>1</sup></a><a href="/tags/Redhat/" style="font-size: 0.88rem;">Redhat<sup>2</sup></a><a href="/tags/Runtimes/" style="font-size: 0.88rem;">Runtimes<sup>4</sup></a><a href="/tags/Ryzen/" style="font-size: 0.88rem;">Ryzen<sup>1</sup></a><a href="/tags/Windows/" style="font-size: 0.88rem;">Windows<sup>12</sup></a><a href="/tags/ansible/" style="font-size: 0.88rem;">ansible<sup>1</sup></a><a href="/tags/cpu/" style="font-size: 0.88rem;">cpu<sup>3</sup></a><a href="/tags/eNSP/" style="font-size: 0.88rem;">eNSP<sup>1</sup></a><a href="/tags/hexo/" style="font-size: 0.88rem;">hexo<sup>2</sup></a><a href="/tags/idm/" style="font-size: 0.88rem;">idm<sup>1</sup></a><a href="/tags/iperf/" style="font-size: 0.88rem;">iperf<sup>1</sup></a><a href="/tags/pip/" style="font-size: 0.88rem;">pip<sup>1</sup></a><a href="/tags/pwn/" style="font-size: 0.88rem;">pwn<sup>1</sup></a><a href="/tags/python/" style="font-size: 0.88rem;">python<sup>1</sup></a><a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 0.88rem;">云计算<sup>2</sup></a><a href="/tags/%E6%98%BE%E7%A4%BA%E5%99%A8/" style="font-size: 0.88rem;">显示器<sup>1</sup></a><a href="/tags/%E6%A0%B7%E9%A2%98/" style="font-size: 0.88rem;">样题<sup>2</sup></a><a href="/tags/%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" style="font-size: 0.88rem;">职业技能大赛<sup>2</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 0.88rem;">虚拟化<sup>1</sup></a><a href="/tags/%E8%A3%85%E6%9C%BA/" style="font-size: 0.88rem; font-weight: 500; color: var(--anzhiyu-lighttext)">装机<sup>3</sup></a><a href="/tags/%E8%B6%85%E9%A2%91/" style="font-size: 0.88rem;">超频<sup>2</sup></a><a href="/tags/%E9%85%8D%E7%BD%AE%E5%8D%95/" style="font-size: 0.88rem;">配置单<sup>2</sup></a><a href="/tags/%E9%87%91%E7%A0%96/" style="font-size: 0.88rem;">金砖<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("10/01/2018 01:23:45"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用神芯微!`,
    `寒江孤影, 相逢何必曾相识`,
    `
      ██╗   ██╗███████╗██╗  ██╗██╗███╗   ██╗██████╗  █████╗ ██████╗ 
      ╚██╗ ██╔╝██╔════╝██║ ██╔╝██║████╗  ██║██╔══██╗██╔══██╗██╔══██╗
       ╚████╔╝ █████╗  █████╔╝ ██║██╔██╗ ██║██║  ██║███████║██████╔╝
        ╚██╔╝  ██╔══╝  ██╔═██╗ ██║██║╚██╗██║██║  ██║██╔══██║██╔══██╗
         ██║   ███████╗██║  ██╗██║██║ ╚████║██████╔╝██║  ██║██║  ██║
         ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝╚═╝  ╚═══╝╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝
																																		
  
        `,
    "已上线",
    dnum,
    "天",
    "©2018 By Zelas2Xerath V1.6.1",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      "color:#3b70fc",
      "",
      "color:#3b70fc",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by Zelas2Xerath %c 你正在访问 Zelas2Xerath 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("10/01/2018 01:23:45"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      img.src = "https://npm.elemecdn.com/hexo-lib@1.0.22/svg/bottom2.svg";
      img.title = "Publicing~";
      img.alt = "Publicing~";

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.56.5/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://c.806006.xyz/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.17/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://c.806006.xyz/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://c.806006.xyz/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.17/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "visitor@806006.xyz";</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script id="click-show-text" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#blog-container","#page-header","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script src="/js/markmap.js"></script></body></html>